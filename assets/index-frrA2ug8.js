const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Index-B5HKV0DS.js","assets/vendor-pKTNhG6C.js","assets/vendor-Dgihpmma.css","assets/android-card-C_mt23GG.js","assets/radix-B53cWD8A.js","assets/NotFound-Beh7tFLs.js","assets/ReportActivityPage-DnjqMssQ.js","assets/card-q4XyeBQj.js","assets/button-BpysZnfQ.js","assets/input-BrGStzQ1.js","assets/label-CzmQRjWT.js","assets/select-BFXux0Fm.js","assets/supabase-Do6c8V9L.js","assets/Dashboard-C4mAyzUg.js","assets/Admin-D-_tSpO9.js","assets/Login-zopu4vRh.js","assets/AdminUsers-D10H_mx_.js","assets/table-DQhVlMOM.js","assets/AdminObservations-0H5gCaln.js","assets/AdminStatistics-DJOFT8MX.js","assets/AdminSettings-BnU_8GXX.js","assets/switch-C0P_jny2.js","assets/AdminNotifications-CYzSCxrx.js","assets/UserProfilePage-CUsOUSgh.js","assets/user-profile-edit-V1DN1th1.js","assets/breadcrumb-BM2uv1s_.js","assets/Settings-CxVqtUU9.js","assets/Privacy-Dbw_Jx0E.js","assets/Help-KDGhLlGO.js"])))=>i.map(i=>d[i]);
import{r as s,t as Je,m as We,j as r,n as $e,X as Fe,p as Ge,$ as qe,q as Ye,C as ye,G as ie,L as He,P as v,v as ee,N as Xe,O as ve,R as q,w as Se,_ as j,Q as Ke,x as Ze,y as Qe,z as er,A as rr}from"./vendor-pKTNhG6C.js";import{V as _e,R as ke,A as Ee,C as je,T as Pe,D as Ae,P as tr,a as De,b as or}from"./radix-B53cWD8A.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const l of d)if(l.type==="childList")for(const g of l.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&a(g)}).observe(document,{childList:!0,subtree:!0});function o(d){const l={};return d.integrity&&(l.integrity=d.integrity),d.referrerPolicy&&(l.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?l.credentials="include":d.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(d){if(d.ep)return;d.ep=!0;const l=o(d);fetch(d.href,l)}})();const sr=1,ar=1e6;let te=0;function nr(){return te=(te+1)%Number.MAX_SAFE_INTEGER,te.toString()}const oe=new Map,he=e=>{if(oe.has(e))return;const t=setTimeout(()=>{oe.delete(e),G({type:"REMOVE_TOAST",toastId:e})},ar);oe.set(e,t)},ir=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,sr)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case"DISMISS_TOAST":{const{toastId:o}=t;return o?he(o):e.toasts.forEach(a=>{he(a.id)}),{...e,toasts:e.toasts.map(a=>a.id===o||o===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==t.toastId)}}},Z=[];let Q={toasts:[]};function G(e){Q=ir(Q,e),Z.forEach(t=>{t(Q)})}function lr({...e}){const t=nr(),o=d=>G({type:"UPDATE_TOAST",toast:{...d,id:t}}),a=()=>G({type:"DISMISS_TOAST",toastId:t});return G({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:d=>{d||a()}}}),{id:t,dismiss:a,update:o}}function dr(){const[e,t]=s.useState(Q);return s.useEffect(()=>(Z.push(t),()=>{const o=Z.indexOf(t);o>-1&&Z.splice(o,1)}),[e]),{...e,toast:lr,dismiss:o=>G({type:"DISMISS_TOAST",toastId:o})}}function w(...e){return Je(We(e))}const cr=tr,Ce=s.forwardRef(({className:e,...t},o)=>r.jsx(_e,{ref:o,className:w("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Ce.displayName=_e.displayName;const ur=$e("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ie=s.forwardRef(({className:e,variant:t,...o},a)=>r.jsx(ke,{ref:a,className:w(ur({variant:t}),e),...o}));Ie.displayName=ke.displayName;const fr=s.forwardRef(({className:e,...t},o)=>r.jsx(Ee,{ref:o,className:w("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));fr.displayName=Ee.displayName;const Ne=s.forwardRef(({className:e,...t},o)=>r.jsx(je,{ref:o,className:w("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:r.jsx(Fe,{className:"h-4 w-4"})}));Ne.displayName=je.displayName;const Oe=s.forwardRef(({className:e,...t},o)=>r.jsx(Pe,{ref:o,className:w("text-sm font-semibold",e),...t}));Oe.displayName=Pe.displayName;const Te=s.forwardRef(({className:e,...t},o)=>r.jsx(Ae,{ref:o,className:w("text-sm opacity-90",e),...t}));Te.displayName=Ae.displayName;function gr(){const{toasts:e}=dr();return r.jsxs(cr,{children:[e.map(function({id:t,title:o,description:a,action:d,...l}){return r.jsxs(Ie,{...l,children:[r.jsxs("div",{className:"grid gap-1",children:[o&&r.jsx(Oe,{children:o}),a&&r.jsx(Te,{children:a})]}),d,r.jsx(Ne,{})]},t)}),r.jsx(Ce,{})]})}const hr=({...e})=>{const{theme:t="system"}=Ge();return r.jsx(qe,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})},mr=or,pr=s.forwardRef(({className:e,sideOffset:t=4,...o},a)=>r.jsx(De,{ref:a,sideOffset:t,className:w("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...o}));pr.displayName=De.displayName;const se="https://vfsyjvjghftfebvxyjba.supabase.co".trim(),ae="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZmc3lqdmpnaGZ0ZmVidnh5amJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNTU3MjYsImV4cCI6MjA2NDYzMTcyNn0.td6SnbD51RuNG_tTuKSC7Jwcz_lUk1tcrcNTwC3OLxc".trim(),ne="sb-vfsyjvjghftfebvxyjba-auth-token";if(!se||!se.startsWith("https://"))throw new Error("Invalid VITE_SUPABASE_URL format");if(!ae||!ae.startsWith("eyJ"))throw new Error("Invalid VITE_SUPABASE_ANON_KEY format");let F=null;const xr={getItem:e=>{try{return localStorage.getItem(e)}catch(t){return console.error(`Error getting item ${e} from storage:`,t),null}},setItem:(e,t)=>{try{localStorage.setItem(e,t)}catch(o){console.error(`Error setting item ${e} in storage:`,o)}},removeItem:e=>{try{localStorage.removeItem(e)}catch(t){console.error(`Error removing item ${e} from storage:`,t)}}},br=()=>{if(F)return F;try{return F=Ye(se,ae,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:xr,storageKey:ne,flowType:"pkce",debug:!1}}),F.auth.getSession().then(({data:e,error:t})=>{t?console.error("Error testing Supabase connection:",t):console.log("Supabase connection test successful:",{hasSession:!!e.session,timestamp:new Date().toISOString()})}),F}catch(e){throw console.error("Error creating Supabase client:",e),e}},z=br(),ut=async()=>{try{console.log("Checking Supabase connection (offline operation will still work)...");let e=!1;try{e=!!localStorage.getItem(ne)}catch(l){console.warn("Error checking local storage for session:",l)}const t=new Promise((l,g)=>{setTimeout(()=>g(new Error("Connection check timed out")),3e3)}),o=z.from("users").select("id").limit(1),{error:a}=await Promise.race([o,t]);if(!a)return console.log("Supabase connection successful"),!0;const d=a==null?void 0:a.status;return d===401||d===403?(console.warn("Supabase reachable but access denied (expected for unauthenticated request)."),!0):e?(console.log("Supabase connection failed, but local session exists. App will work offline."),!0):(console.error("Supabase connection error:",a),!1)}catch(e){try{if(localStorage.getItem(ne))return console.log("Supabase connection check failed, but local session exists. Will work offline."),!0}catch(t){console.warn("Error checking local storage for session:",t)}return console.error("Supabase connection error:",e),!1}},wr=()=>{const[e,t]=s.useState(navigator.onLine);return s.useEffect(()=>{const o=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",o),window.addEventListener("offline",a),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",a)}},[]),{isOnline:e}},Le=async()=>{if(console.log("Requesting location permission"),!ye.isNativePlatform())return console.warn("Geolocation is not available on web platform. Returning default denied status."),{location:"denied",coarseLocation:"denied"};try{const e=await ie.requestPermissions();return console.log("Location permission status:",e),e}catch(e){throw console.error("Error requesting location permission:",e),e}},yr=async()=>{try{return(await ie.checkPermissions()).location==="granted"}catch(e){return console.error("Error checking location permissions:",e),!1}},vr=async()=>{if(!ye.isNativePlatform())return console.warn("Geolocation is not available on web platform. Returning default location."),{latitude:0,longitude:0,accuracy:0,timestamp:Date.now()};try{if(!await yr()&&(await Le()).location!=="granted")throw new Error("Location permission denied");const t=await ie.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4,maximumAge:0});return{latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy,timestamp:t.timestamp}}catch(e){throw console.error("Error getting current position:",e),e}},E=({message:e="Loading..."})=>r.jsx("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-background/80 backdrop-blur-sm",children:r.jsxs("div",{className:"text-center",children:[r.jsx(He,{className:"mx-auto mb-4 h-12 w-12 animate-spin text-primary"}),r.jsx("p",{className:"text-lg font-semibold text-foreground",children:e}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait a moment."})]})}),M="sb-vfsyjvjghftfebvxyjba-auth-token",me=30*24*60*60*1e3,Re={user:null,session:null,loading:!0,error:null,initialized:!1},Ue=s.createContext({...Re,signIn:async()=>({user:null,error:new Error("AuthContext not initialized")}),signOut:async()=>({error:new Error("AuthContext not initialized")}),refreshUser:async()=>{},resetPassword:async()=>({error:new Error("AuthContext not initialized")}),updatePassword:async()=>({error:new Error("AuthContext not initialized")}),canCreateUserWithRole:()=>!1,canManageUsers:()=>!1,canViewReports:()=>!1,canEditReports:()=>!1,hasPermission:()=>!1,setNavigation:()=>{},navigate:()=>console.warn("Navigation not initialized"),isAdmin:!1,initialized:!1}),Sr=({children:e})=>{const[t,o]=s.useState(Re),[a,d]=s.useState(()=>c=>{console.warn("Navigation not yet initialized. Attempted to navigate to:",c)}),{isOnline:l}=wr(),g=async(c,n,u)=>{const i=new Promise((C,O)=>{const T=setTimeout(()=>{clearTimeout(T),O(new Error(`Timeout after ${n}ms: ${u}`))},n)});return Promise.race([c,i])},b=s.useCallback(async c=>{var C,O,T;console.log("Checking Supabase connection (will continue offline if unavailable)...",c),console.log("fetchUserProfile: Checking for cached user data first..."),console.log("fetchUserProfile: Calling supabase.auth.getUser()...");let n=null,u=null;try{let I;try{I=await g(z.auth.getUser(),1e4,"supabase.auth.getUser() call timed out")}catch(k){throw console.error("fetchUserProfile: Timeout error:",k),new Error("Could not get authentication data: network request timed out")}const{data:{user:W},error:N}=I;if(n=W,console.log("fetchUserProfile: supabase.auth.getUser() completed. User error:",N,"User exists:",!!n),console.log("DEBUG: supabaseUser object:",n),N){if(console.error("fetchUserProfile: Error from supabase.auth.getUser():",N),N.name==="AuthSessionMissingError")return console.warn("fetchUserProfile: Auth session missing. Treating as no user logged in."),null;throw N}if(!n)return console.warn("fetchUserProfile: No user returned from supabase.auth.getUser(). Treating as no user logged in."),null;let J;try{J=await g((async()=>{if(!n)throw new Error("Cannot fetch profile: user is null");return await z.from("users").select("id, first_name, last_name, email, phone, role, position").eq("auth_id",n.id).single()})(),1e4,"Profile fetch from Supabase timed out")}catch(k){throw console.error("fetchUserProfile: Profile fetch timeout:",k),new Error("Could not get profile data: network request timed out")}const{data:x,error:m}=J;if(u=x,console.log("DEBUG: Profile data from 'profiles' table:",u),console.log("DEBUG: Profile fetch error:",m),console.log("DEBUG: Role from profileData:",u==null?void 0:u.role),m)throw console.error("fetchUserProfile: Error fetching profile from 'profiles' table:",m),m;if(!u)throw console.warn("fetchUserProfile: No profile data found for user:",n.id),new Error("No profile data found.")}catch(I){throw console.error("fetchUserProfile: An unexpected error occurred during user profile fetch:",I),I}const i={id:n.id,auth_id:n.id,first_name:(u==null?void 0:u.first_name)||"",last_name:(u==null?void 0:u.last_name)||"",email:n.email||null,phone:n.phone||null,role:(u==null?void 0:u.role)||"viewer",position:((C=n.user_metadata)==null?void 0:C.position)||"field_agent",status:((O=n.user_metadata)==null?void 0:O.status)||"active",created_at:n.created_at||new Date().toISOString(),updated_at:n.updated_at||new Date().toISOString(),last_login_at:n.last_sign_in_at||null,avatar_url:"",metadata:n.user_metadata||{},permissions:((T=n.user_metadata)==null?void 0:T.permissions)||[],cached_at:new Date().toISOString()};return console.log("DEBUG: Final extendedUser object before return:",i),console.log("DEBUG: Role in final extendedUser object:",i.role),i},[]);s.useEffect(()=>{let c=!0;console.log("AuthProvider: Running initialization effect."),(async u=>{var O,T,I,W,N,J,x,m,k,f,L,R,S,V;console.log("AuthProvider: Starting initializeAuth.");let i=null,C=null;try{console.log("AuthProvider: Attempting to load session from preferences...");const{value:U}=await v.get({key:M});if(console.log("AuthProvider: Preferences.get completed. Stored session exists:",!!U),U)try{const y=JSON.parse(U),A=y.created_at||y.expires_at,fe=new Date(A).getTime();if(new Date().getTime()-fe<me)if(!u)i=y,console.log("AuthProvider: Offline mode - using stored session without validation.");else try{y&&y.access_token?(await z.auth.setSession(y),i=y,console.log("AuthProvider: Session restored and validated with Supabase.")):(console.warn("AuthProvider: Parsed session is invalid or missing access_token. Not setting session."),await v.remove({key:M}))}catch(re){console.error("AuthProvider: Error validating session with Supabase:",re),re instanceof Error&&re.name==="AuthSessionMissingError"?(console.log("AuthProvider: AuthSessionMissingError during validation. Clearing session."),await v.remove({key:M}),i=null):(console.log("AuthProvider: Online validation failed, but session is within 30 days. Keeping session."),i=y)}else console.log("AuthProvider: Stored session expired (older than 30 days). Clearing."),await v.remove({key:M})}catch(y){console.error("AuthProvider: Failed to parse stored session.",y),await v.remove({key:M}),console.log("AuthProvider: Invalid session format. Clearing.")}if(!i&&u){console.log("AuthProvider: No session from preferences, attempting to get from Supabase...");try{const{data:{session:y},error:A}=await z.auth.getSession();A?(console.error("AuthProvider: Error getting session from Supabase:",A),A.name==="AuthSessionMissingError"&&(console.log("AuthProvider: AuthSessionMissingError when getting session. Clearing session."),await v.remove({key:M}),i=null)):(console.log("AuthProvider: supabase.auth.getSession completed. Session exists:",!!y),i=y,console.log("AuthProvider: Fetched session from Supabase."))}catch{console.warn("AuthProvider: Failed to get session from Supabase (possibly network issue or unexpected error):")}}if(i!=null&&i.user)if(console.log("AuthProvider: Session user found, attempting to fetch user profile."),u)try{C=await b(i.user.id),console.log("AuthProvider: fetchUserProfile completed.")}catch(y){console.warn("AuthProvider: Failed to fetch user profile during initialization (possibly offline or error).",y),C={id:i.user.id,auth_id:i.user.id,first_name:((O=i.user.user_metadata)==null?void 0:O.first_name)||"",last_name:((T=i.user.user_metadata)==null?void 0:T.last_name)||"",email:i.user.email||null,phone:i.user.phone||null,role:((I=i.user.user_metadata)==null?void 0:I.role)||"viewer",position:((W=i.user.user_metadata)==null?void 0:W.position)||"field_agent",status:((N=i.user.user_metadata)==null?void 0:N.status)||"active",created_at:i.user.created_at||new Date().toISOString(),updated_at:i.user.updated_at||new Date().toISOString(),last_login_at:i.user.last_sign_in_at||new Date().toISOString(),avatar_url:((J=i.user.user_metadata)==null?void 0:J.avatar_url)||"",metadata:i.user.user_metadata||{},permissions:((x=i.user.user_metadata)==null?void 0:x.permissions)||[]}}else{C={id:i.user.id,auth_id:i.user.id,first_name:((m=i.user.user_metadata)==null?void 0:m.first_name)||"",last_name:((k=i.user.user_metadata)==null?void 0:k.last_name)||"",email:i.user.email||null,phone:i.user.phone||null,role:((f=i.user.user_metadata)==null?void 0:f.role)||"viewer",position:((L=i.user.user_metadata)==null?void 0:L.position)||"field_agent",status:((R=i.user.user_metadata)==null?void 0:R.status)||"active",created_at:i.user.created_at||new Date().toISOString(),updated_at:i.user.updated_at||new Date().toISOString(),last_login_at:i.user.last_sign_in_at||new Date().toISOString(),avatar_url:((S=i.user.user_metadata)==null?void 0:S.avatar_url)||"",metadata:i.user.user_metadata||{},permissions:((V=i.user.user_metadata)==null?void 0:V.permissions)||[],cached_at:new Date().toISOString()};try{const{value:y}=await v.get({key:`user_profile_${i.user.id}`});if(y){const A=JSON.parse(y);A.avatar_url&&!C.avatar_url&&(C.avatar_url=A.avatar_url)}}catch(y){console.warn("AuthProvider: Error retrieving cached profile:",y)}console.log("AuthProvider: Offline, using session user for profile.")}}catch(U){console.error("AuthProvider: Error during main initialization process:",U)}finally{console.log("AuthProvider: initializeAuth finally block reached. isMounted:",c),o(U=>({...U,user:C,session:i,error:null,loading:!1,initialized:!0}))}})(l)},[l,b]);const h=s.useCallback(async(c,n,u=!0)=>{var C,O,T,I,W,N,J;console.log("handleSignIn: Attempting to sign in user:",c),o(x=>({...x,loading:!0,error:null}));const i={email:c,timestamp:new Date().toISOString(),success:!1,online:l,deviceInfo:{userAgent:navigator.userAgent,platform:navigator.platform,screenSize:`${window.screen.width}x${window.screen.height}`}};try{await Le();try{const x=await vr();i.location=x;try{const{value:m}=await v.get({key:"login_history"});let k=m?JSON.parse(m):[];if(k.length>0){const f=k.length-1;k[f].email===c&&(k[f].location=i.location,await v.set({key:"login_history",value:JSON.stringify(k)}),console.log("Location data added to login history"))}}catch(m){console.warn("Failed to update location in login history:",m)}}catch(x){console.warn("Error getting location:",x)}}catch(x){console.warn("Location permission error:",x)}try{if(window.DeviceOrientationEvent){const x=m=>{window.removeEventListener("deviceorientation",x),m.alpha!==null&&(i.orientation={alpha:m.alpha,beta:m.beta,gamma:m.gamma},v.get({key:"login_history"}).then(({value:k})=>{let f=k?JSON.parse(k):[];if(f.length>0){const L=f.length-1;f[L].email===c&&(f[L].orientation=i.orientation,v.set({key:"login_history",value:JSON.stringify(f)}),console.log("Orientation data added to login history"))}}).catch(k=>{console.warn("Failed to update orientation in login history:",k)}))};window.addEventListener("deviceorientation",x,!0)}}catch(x){console.warn("Error accessing device sensors:",x)}try{const{value:x}=await v.get({key:"login_history"}),m=x?JSON.parse(x):[];if(m.push(i),await v.set({key:"login_history",value:JSON.stringify(m)}),!l){console.log("handleSignIn: Offline mode, checking cached session");try{const{value:S}=await v.get({key:M});if(S){const V=JSON.parse(S),{value:U}=await v.get({key:`user_profile_${V.user.id}`});if(U){const A=JSON.parse(U);if(A.email===c)return console.log("handleSignIn: Offline login successful with cached credentials"),m[m.length-1].success=!0,await v.set({key:"login_history",value:JSON.stringify(m)}),o(ge=>({...ge,user:A,session:V,loading:!1,error:null})),{user:A,error:null}}const y=new Error("Offline login failed. Please ensure you've logged in at least once with internet connection.");return o(A=>({...A,loading:!1,error:y.message})),{user:null,error:y}}}catch(S){return console.error("handleSignIn: Error during offline login:",S),o(V=>({...V,loading:!1,error:"Offline login failed. No cached session available."})),{user:null,error:S instanceof Error?S:new Error("Offline login failed")}}}console.log("handleSignIn: Online mode, calling Supabase auth");const k=await g(z.auth.signInWithPassword({email:c,password:n}),15e3,"Supabase auth login request timed out"),{data:f,error:L}=k;if(L)return console.error("handleSignIn: Error signing in with Supabase:",L),o(S=>({...S,loading:!1,error:L.message})),{user:null,error:L};if(!f.user||!f.session){const S=new Error("No user or session returned from Supabase auth");return console.error("handleSignIn: No user returned in auth response"),o(V=>({...V,loading:!1,error:S.message})),{user:null,error:S}}if(console.log("handleSignIn: Supabase auth successful, getting full user profile"),m[m.length-1].success=!0,await v.set({key:"login_history",value:JSON.stringify(m)}),u){const S={...f.session,created_at:new Date().toISOString(),local_expiry:new Date(Date.now()+me).toISOString()};await v.set({key:M,value:JSON.stringify(S)}),console.log("handleSignIn: Session stored with 30-day local expiration date:",S.local_expiry)}let R=null;try{if(R=await b(f.user.id),!R)return console.warn("handleSignIn: fetchUserProfile returned null. User profile not found or session invalid."),await v.remove({key:M}),o(S=>({...S,loading:!1,user:null,session:null,error:"User profile not found or session invalid."})),{user:null,error:new Error("User profile not found or session invalid.")};await v.set({key:`user_profile_${f.user.id}`,value:JSON.stringify({...R,cached_at:new Date().toISOString()})}),console.log("handleSignIn: User profile fetched and cached successfully")}catch(S){console.warn("handleSignIn: Error fetching full profile, using basic user data",S),R={id:f.user.id,auth_id:f.user.id,first_name:((C=f.user.user_metadata)==null?void 0:C.first_name)||"",last_name:((O=f.user.user_metadata)==null?void 0:O.last_name)||"",email:f.user.email||null,phone:f.user.phone||null,role:((T=f.user.user_metadata)==null?void 0:T.role)||"viewer",position:((I=f.user.user_metadata)==null?void 0:I.position)||"field_agent",status:((W=f.user.user_metadata)==null?void 0:W.status)||"active",created_at:f.user.created_at||new Date().toISOString(),updated_at:f.user.updated_at||new Date().toISOString(),last_login_at:f.user.last_sign_in_at||new Date().toISOString(),avatar_url:((N=f.user.user_metadata)==null?void 0:N.avatar_url)||"",metadata:f.user.user_metadata||{},permissions:((J=f.user.user_metadata)==null?void 0:J.permissions)||[],cached_at:new Date().toISOString()},await v.set({key:`user_profile_${f.user.id}`,value:JSON.stringify(R)})}return o(S=>({...S,user:R,session:f.session,loading:!1,error:null})),{user:R,error:null}}catch(x){return console.error("handleSignIn: Unexpected error during sign in:",x),o(m=>({...m,loading:!1,error:x instanceof Error?x.message:"An unexpected error occurred"})),{user:null,error:x instanceof Error?x:new Error("Unknown error during sign in")}}},[o,l,b]),B=s.useCallback(async()=>{var c;console.log("handleSignOut: Signing out user"),o(n=>({...n,loading:!0,error:null}));try{const{value:n}=await v.get({key:"login_history"}),u=n?JSON.parse(n):[];if(u.push({timestamp:new Date().toISOString(),event:"signout",online:l,userId:((c=t.user)==null?void 0:c.id)||null}),await v.set({key:"login_history",value:JSON.stringify(u)}),l){const{error:i}=await z.auth.signOut();if(i)throw i}return await v.remove({key:M}),o({user:null,session:null,loading:!1,error:null,initialized:!0}),{error:null}}catch(n){return console.error("Error signing out:",n),o(u=>({...u,loading:!1,error:n instanceof Error?n.message:"Error signing out"})),{error:n instanceof Error?n:new Error("Error signing out")}}},[o,l,t.user]),p=s.useCallback(async c=>{console.log("handleResetPassword: Requesting password reset for:",c),o(n=>({...n,loading:!0,error:null}));try{if(!l)throw new Error("Cannot reset password while offline");const{error:n}=await z.auth.resetPasswordForEmail(c,{redirectTo:window.location.origin+"/reset-password"});if(n)throw n;return o(u=>({...u,loading:!1})),{error:null}}catch(n){return console.error("Error resetting password:",n),o(u=>({...u,loading:!1,error:n instanceof Error?n.message:"Error resetting password"})),{error:n instanceof Error?n:new Error("Error resetting password")}}},[o,l]),D=s.useCallback(async c=>{console.log("handleUpdatePassword: Updating password"),o(n=>({...n,loading:!0,error:null}));try{if(!l)throw new Error("Cannot update password while offline");const{error:n}=await z.auth.updateUser({password:c});if(n)throw n;return o(u=>({...u,loading:!1})),{error:null}}catch(n){return console.error("Error updating password:",n),o(u=>({...u,loading:!1,error:n instanceof Error?n.message:"Error updating password"})),{error:n instanceof Error?n:new Error("Error updating password")}}},[o,l]),_=s.useCallback(c=>{d(()=>c)},[]),P=s.useCallback(async()=>{try{const{data:{user:c},error:n}=await z.auth.getUser();if(n)throw n;if(!c)return;const u=await b(c.id);u&&o(i=>({...i,user:u}))}catch(c){throw console.error("Error refreshing user:",c),c}},[o,b]),$=s.useMemo(()=>{var c;return((c=t.user)==null?void 0:c.role)==="admin"},[t.user]),le=s.useMemo(()=>{var c;return((c=t.user)==null?void 0:c.role)==="manager"},[t.user]),de=s.useMemo(()=>{var c;return((c=t.user)==null?void 0:c.role)==="data_collector"},[t.user]),ce=s.useCallback(c=>{if(!t.user)return!1;switch(t.user.role){case"admin":return!0;case"manager":return["data_collector","viewer"].includes(c);default:return!1}},[t.user]),Y=s.useCallback(()=>$||le,[$,le]),H=s.useCallback(()=>!!t.user,[t.user]),X=s.useCallback(()=>$||de,[$,de]),ue=s.useCallback(c=>{if(!t.user)return!1;switch(c){case"manage_users":return Y();case"view_reports":return H();case"edit_reports":return X();default:return!1}},[t.user,Y,H,X]),Be=s.useMemo(()=>{var c;return{...t,signIn:h,signOut:B,refreshUser:P,resetPassword:p,updatePassword:D,canCreateUserWithRole:ce,canManageUsers:Y,canViewReports:H,canEditReports:X,hasPermission:ue,setNavigation:_,navigate:n=>{a?a(n):console.warn("Navigation not initialized")},isAdmin:((c=t.user)==null?void 0:c.role)==="admin",initialized:t.initialized}},[t,h,B,P,p,D,ce,Y,H,X,ue,a,_]);return t.initialized?r.jsx(Ue.Provider,{value:Be,children:e}):r.jsx(E,{message:"Initializing authentication..."})},_r=()=>{const e=s.useContext(Ue);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},kr=()=>{const{user:e,initialized:t}=_r(),o=ee();return t?e?r.jsx(ve,{}):r.jsx(Xe,{to:"/login",state:{from:o},replace:!0}):r.jsx(E,{message:"Initializing session..."})};function Er({className:e,items:t,value:o,onValueChange:a,showLabels:d="always",...l}){const g=ee(),[b,h]=s.useState(o||pe(g.pathname,t));q.useEffect(()=>{o||h(pe(g.pathname,t))},[g.pathname,t,o]),q.useEffect(()=>{o&&h(o)},[o]);const B=p=>{h(p),a&&a(p)};return r.jsx("div",{className:w("fixed bottom-0 left-0 right-0 z-50","bg-white dark:bg-gray-800","border-t border-gray-100 dark:border-gray-700","flex items-center justify-around","h-16 px-1","shadow-lg shadow-gray-100/50 dark:shadow-gray-900/20","backdrop-blur-sm bg-white/95 dark:bg-gray-800/95",e),...l,children:t.map(p=>{const D=b===p.id;return r.jsxs(Se,{to:p.href,onClick:()=>!p.disabled&&B(p.id),className:w("relative flex-1 flex flex-col items-center justify-center h-full px-2","transition-all duration-200",D?"text-blue-500 dark:text-blue-300":"text-gray-500 dark:text-gray-400",p.disabled?"opacity-40 cursor-not-allowed":"hover:text-blue-400 hover:-translate-y-0.5 active:translate-y-0 dark:hover:text-blue-300","focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-400/70 focus-visible:ring-offset-2 rounded-md"),"aria-current":D?"page":void 0,"aria-disabled":p.disabled,tabIndex:p.disabled?-1:0,children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:w("text-xl",D?"scale-110 transition-transform text-blue-500 dark:text-blue-300":"text-gray-500 dark:text-gray-400"),children:p.icon}),p.badgeCount&&p.badgeCount>0&&r.jsx("span",{className:w("absolute -top-1 -right-1","flex items-center justify-center","min-w-[18px] h-[18px]","text-[10px] font-medium","rounded-full","bg-red-500 text-white","shadow-sm","border border-white dark:border-gray-800","px-1"),children:p.badgeCount>99?"99+":p.badgeCount})]}),(d==="always"||d==="selected"&&D)&&r.jsx("span",{className:w("mt-1 text-xs font-medium","whitespace-nowrap overflow-hidden text-ellipsis","max-w-full",D?"text-blue-500 dark:text-blue-300":"text-gray-500 dark:text-gray-400"),children:p.label}),D&&r.jsx("div",{className:"absolute bottom-0 w-12 h-0.5 rounded-t-full bg-blue-500 dark:bg-blue-300 shadow-sm transition-all duration-200"})]},p.id)})})}function pe(e,t){const o=t.find(l=>l.href===e);if(o)return o.id;const a=t.find(l=>e.startsWith(l.href)&&l.href!=="/");if(a)return a.id;const d=t.find(l=>!l.disabled);return d?d.id:t[0].id}function jr({className:e,items:t,value:o,onValueChange:a,showLabels:d="selected",header:l,fab:g,...b}){const h=ee(),[B,p]=s.useState(o||xe(h.pathname,t));q.useEffect(()=>{o||p(xe(h.pathname,t))},[h.pathname,t,o]),q.useEffect(()=>{o&&p(o)},[o]);const D=_=>{p(_),a&&a(_)};return r.jsxs("div",{className:w("fixed top-0 left-0 bottom-0 z-50","bg-white dark:bg-gray-800","border-r border-gray-100 dark:border-gray-700","flex flex-col items-center","w-20 py-3 px-1","shadow-lg shadow-gray-100/50 dark:shadow-gray-900/20","backdrop-blur-sm bg-white/95 dark:bg-gray-800/95",e),...b,children:[l&&r.jsx("div",{className:"mb-4 w-full flex justify-center",children:l}),g&&r.jsx("div",{className:"mb-6 mt-2 w-full flex justify-center",children:g}),r.jsx("div",{className:"flex-1 w-full flex flex-col items-center gap-4 overflow-y-auto py-2",children:t.map(_=>{const P=B===_.id;return r.jsxs(Se,{to:_.href,onClick:()=>!_.disabled&&D(_.id),className:w("relative flex flex-col items-center justify-center","w-full py-3 px-1","transition-all duration-200 rounded-lg",P?"bg-blue-50 text-blue-500 dark:bg-blue-900/30 dark:text-blue-300 shadow-sm":"text-gray-600 dark:text-gray-400",_.disabled?"opacity-40 cursor-not-allowed":"hover:bg-gray-50 hover:text-blue-400 hover:-translate-y-0.5 active:translate-y-0 dark:hover:bg-gray-700/50 dark:hover:text-blue-300","focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-400/70 focus-visible:ring-offset-2"),"aria-current":P?"page":void 0,"aria-disabled":_.disabled,tabIndex:_.disabled?-1:0,children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:w("text-xl",P?"scale-110 transition-transform text-blue-500 dark:text-blue-300":"text-gray-500 dark:text-gray-400"),children:_.icon}),_.badgeCount&&_.badgeCount>0&&r.jsx("span",{className:w("absolute -top-1 -right-1","flex items-center justify-center","min-w-[18px] h-[18px]","text-[10px] font-medium","rounded-full","bg-red-500 text-white","shadow-sm","border border-white dark:border-gray-800","px-1"),children:_.badgeCount>99?"99+":_.badgeCount})]}),(d==="always"||d==="selected"&&P)&&r.jsx("span",{className:w("mt-1.5 text-xs font-medium","whitespace-nowrap overflow-hidden text-ellipsis","max-w-full text-center",P?"text-blue-500 dark:text-blue-300":"text-gray-500 dark:text-gray-400"),children:_.label})]},_.id)})})]})}function xe(e,t){const o=t.find(l=>l.href===e);if(o)return o.id;const a=t.find(l=>e.startsWith(l.href)&&l.href!=="/");if(a)return a.id;const d=t.find(l=>!l.disabled);return d?d.id:t[0].id}const be={colors:{primary:"#1a73e8",onPrimary:"#ffffff",primaryContainer:"#e8f1fe",onPrimaryContainer:"#0d3c78",secondary:"#0b8043",onSecondary:"#ffffff",secondaryContainer:"#e6f5ed",onSecondaryContainer:"#07522b",tertiary:"#00a0b0",onTertiary:"#ffffff",tertiaryContainer:"#e0f7fa",onTertiaryContainer:"#006a75",error:"#dc2626",onError:"#ffffff",errorContainer:"#fee2e2",onErrorContainer:"#7f1d1d",background:"#f8fafc",onBackground:"#1c2434",surface:"#ffffff",onSurface:"#1c2434",surfaceVariant:"#f1f5f9",onSurfaceVariant:"#475569",outline:"#cbd5e1",shadow:"rgba(0, 0, 0, 0.06)",inverseSurface:"#1c2434",inverseOnSurface:"#f8fafc",inversePrimary:"#7eb6ff"},typography:{fontFamily:"Roboto, system-ui, sans-serif",displayLarge:"text-6xl font-normal leading-tight tracking-tighter",displayMedium:"text-5xl font-normal leading-tight tracking-tight",displaySmall:"text-4xl font-normal leading-tight",headlineLarge:"text-3xl font-normal leading-snug",headlineMedium:"text-2xl font-normal leading-snug",headlineSmall:"text-xl font-normal leading-snug",titleLarge:"text-lg font-medium leading-normal",titleMedium:"text-base font-medium leading-normal tracking-wide",titleSmall:"text-sm font-medium leading-normal tracking-wide",labelLarge:"text-sm font-medium leading-normal",labelMedium:"text-xs font-medium leading-normal tracking-wide",labelSmall:"text-[0.6875rem] font-medium leading-normal tracking-wide",bodyLarge:"text-base font-normal leading-relaxed",bodyMedium:"text-sm font-normal leading-relaxed",bodySmall:"text-xs font-normal leading-relaxed"},shape:{cornerSmall:"rounded",cornerMedium:"rounded-md",cornerLarge:"rounded-lg",cornerExtraLarge:"rounded-xl"},spacing:{xs:"0.25rem",sm:"0.5rem",md:"1rem",lg:"1.5rem",xl:"2rem",xxl:"3rem"},isDark:!1},Pr={colors:{primary:"#8ab4f8",onPrimary:"#003785",primaryContainer:"#004aac",onPrimaryContainer:"#d6e2ff",secondary:"#a5d6a7",onSecondary:"#1b5e20",secondaryContainer:"#2e7d32",onSecondaryContainer:"#c8e6c9",tertiary:"#4db6ac",onTertiary:"#003731",tertiaryContainer:"#004f45",onTertiaryContainer:"#b2f5ea",error:"#ffb4ab",onError:"#690005",errorContainer:"#93000a",onErrorContainer:"#ffdad6",background:"#121212",onBackground:"#e1e2e5",surface:"#191c1e",onSurface:"#e1e2e5",surfaceVariant:"#43474e",onSurfaceVariant:"#c3c7cf",outline:"#8d9199",shadow:"#000000",inverseSurface:"#e1e2e5",inverseOnSurface:"#2e3133",inversePrimary:"#006abc"},typography:{fontFamily:"Roboto, system-ui, sans-serif",displayLarge:"text-6xl font-normal leading-tight tracking-tighter",displayMedium:"text-5xl font-normal leading-tight tracking-tight",displaySmall:"text-4xl font-normal leading-tight",headlineLarge:"text-3xl font-normal leading-snug",headlineMedium:"text-2xl font-normal leading-snug",headlineSmall:"text-xl font-normal leading-snug",titleLarge:"text-lg font-medium leading-normal",titleMedium:"text-base font-medium leading-normal tracking-wide",titleSmall:"text-sm font-medium leading-normal tracking-wide",labelLarge:"text-sm font-medium leading-normal",labelMedium:"text-xs font-medium leading-normal tracking-wide",labelSmall:"text-[0.6875rem] font-medium leading-normal tracking-wide",bodyLarge:"text-base font-normal leading-relaxed",bodyMedium:"text-sm font-normal leading-relaxed",bodySmall:"text-xs font-normal leading-relaxed"},shape:{cornerSmall:"rounded",cornerMedium:"rounded-md",cornerLarge:"rounded-lg",cornerExtraLarge:"rounded-xl"},spacing:{xs:"0.25rem",sm:"0.5rem",md:"1rem",lg:"1.5rem",xl:"2rem",xxl:"3rem"},isDark:!0},Me=s.createContext(void 0),ze=()=>{const e=s.useContext(Me);if(e===void 0)throw new Error("useAndroidTheme must be used within an AndroidThemeProvider");return e},Ar=({children:e,initialTheme:t=be})=>{const[o,a]=q.useState(t),d=()=>{a(o.isDark?be:Pr)};return r.jsx(Me.Provider,{value:{theme:o,setTheme:a,toggleDarkMode:d},children:r.jsx("div",{className:o.isDark?"dark":"",children:e})})},Dr=(e,t,o="bg")=>{var d;return((d={primary:{bg:e.isDark?"bg-blue-400":"bg-blue-600",text:e.isDark?"text-blue-400":"text-blue-600",border:e.isDark?"border-blue-400":"border-blue-600"},onPrimary:{bg:"bg-white",text:"text-white",border:"border-white"},primaryContainer:{bg:e.isDark?"bg-blue-900":"bg-blue-100",text:e.isDark?"text-blue-900":"text-blue-100",border:e.isDark?"border-blue-900":"border-blue-100"},onPrimaryContainer:{bg:e.isDark?"bg-blue-50":"bg-blue-900",text:e.isDark?"text-blue-50":"text-blue-900",border:e.isDark?"border-blue-50":"border-blue-900"},secondary:{bg:e.isDark?"bg-slate-300":"bg-slate-600",text:e.isDark?"text-slate-300":"text-slate-600",border:e.isDark?"border-slate-300":"border-slate-600"},onSecondary:{bg:"bg-white",text:"text-white",border:"border-white"},secondaryContainer:{bg:e.isDark?"bg-slate-700":"bg-slate-100",text:e.isDark?"text-slate-700":"text-slate-100",border:e.isDark?"border-slate-700":"border-slate-100"},onSecondaryContainer:{bg:e.isDark?"bg-slate-100":"bg-slate-900",text:e.isDark?"text-slate-100":"text-slate-900",border:e.isDark?"border-slate-100":"border-slate-900"},error:{bg:e.isDark?"bg-red-400":"bg-red-600",text:e.isDark?"text-red-400":"text-red-600",border:e.isDark?"border-red-400":"border-red-600"},onError:{bg:"bg-white",text:"text-white",border:"border-white"},errorContainer:{bg:e.isDark?"bg-red-900":"bg-red-100",text:e.isDark?"text-red-900":"text-red-100",border:e.isDark?"border-red-900":"border-red-100"},onErrorContainer:{bg:e.isDark?"bg-red-100":"bg-red-900",text:e.isDark?"text-red-100":"text-red-900",border:e.isDark?"border-red-100":"border-red-900"},background:{bg:e.isDark?"bg-neutral-900":"bg-neutral-50",text:e.isDark?"text-neutral-900":"text-neutral-50",border:e.isDark?"border-neutral-900":"border-neutral-50"},onBackground:{bg:e.isDark?"bg-neutral-100":"bg-neutral-900",text:e.isDark?"text-neutral-100":"text-neutral-900",border:e.isDark?"border-neutral-100":"border-neutral-900"},surface:{bg:e.isDark?"bg-neutral-800":"bg-white",text:e.isDark?"text-neutral-800":"text-white",border:e.isDark?"border-neutral-800":"border-white"},onSurface:{bg:e.isDark?"bg-neutral-100":"bg-neutral-900",text:e.isDark?"text-neutral-100":"text-neutral-900",border:e.isDark?"border-neutral-100":"border-neutral-900"},surfaceVariant:{bg:e.isDark?"bg-neutral-700":"bg-neutral-100",text:e.isDark?"text-neutral-700":"text-neutral-100",border:e.isDark?"border-neutral-700":"border-neutral-100"},onSurfaceVariant:{bg:e.isDark?"bg-neutral-200":"bg-neutral-700",text:e.isDark?"text-neutral-200":"text-neutral-700",border:e.isDark?"border-neutral-200":"border-neutral-700"},outline:{bg:e.isDark?"bg-neutral-500":"bg-neutral-300",text:e.isDark?"text-neutral-500":"text-neutral-300",border:e.isDark?"border-neutral-500":"border-neutral-300"}}[t])==null?void 0:d[o])||""},Cr=(e,t)=>e.typography[t]||"",Ir=e=>({0:"shadow-none",1:"shadow-sm",2:"shadow",3:"shadow-md",4:"shadow-lg",5:"shadow-xl"})[e]||"shadow-none",Nr=(e,t)=>e.shape[t]||"",K=(e,t,o,a)=>{const d={"":"",x:"x",y:"y",l:"l",r:"r",t:"t",b:"b"},l=e.spacing[a].replace("rem",""),g=parseFloat(l);let b="0";return g===.25?b="1":g===.5?b="2":g===1?b="4":g===1.5?b="6":g===2?b="8":g===3?b="12":g===4&&(b="16"),`${t}${d[o]}-${b}`},Ve=(e,t="",o={})=>{const a=[t];return o.color&&a.push(Dr(e,o.color,o.colorType||"bg")),o.typography&&a.push(Cr(e,o.typography)),o.elevation!==void 0&&a.push(Ir(o.elevation)),o.shape&&a.push(Nr(e,o.shape)),o.paddingX&&a.push(K(e,"p","x",o.paddingX)),o.paddingY&&a.push(K(e,"p","y",o.paddingY)),o.marginX&&a.push(K(e,"m","x",o.marginX)),o.marginY&&a.push(K(e,"m","y",o.marginY)),w(...a)};function Or({className:e,elevated:t=!0,title:o,navigationIcon:a,onNavigationIconClick:d,actions:l=[],prominent:g=!1,centerTitle:b=!1,bottom:h,children:B,...p}){const{theme:D}=ze(),_=Ve(D,"bg-primary text-onPrimary");return r.jsxs("header",{className:w("relative w-full flex flex-col",t?"shadow-md":"border-b border-gray-200 dark:border-gray-800",_,e),...p,children:[r.jsxs("div",{className:w("flex items-center gap-4 px-4",g?"h-24":"h-14"),children:[a&&r.jsx("button",{type:"button",onClick:d,className:w("flex items-center justify-center","w-10 h-10 rounded-full","text-current","hover:bg-white/10 active:bg-white/20","focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75"),"aria-label":"Navigation",children:a}),o&&r.jsx("h1",{className:w("font-medium truncate text-white",g?"text-2xl":"text-xl",b&&"absolute left-1/2 transform -translate-x-1/2",b&&a&&"pl-10",b&&l.length>0&&"pr-10"),children:o}),l.length>0&&r.jsx("div",{className:"flex items-center gap-1 ml-auto",children:l.map((P,$)=>r.jsx("button",{type:"button",onClick:P.onClick,disabled:P.disabled,className:w("flex items-center justify-center","w-10 h-10 rounded-full","text-current","hover:bg-white/10 active:bg-white/20","focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75","disabled:opacity-40 disabled:cursor-not-allowed"),"aria-label":P.label,title:P.label,children:P.icon},$))}),B]}),h&&r.jsx("div",{className:"w-full bg-inherit",children:h})]})}const Tr=()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Lr=()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"9"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"5"}),r.jsx("rect",{x:"14",y:"12",width:"7",height:"9"}),r.jsx("rect",{x:"3",y:"16",width:"7",height:"5"})]}),Rr=()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("polygon",{points:"3 11 22 2 13 21 11 13 3 11"})}),Ur=()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"}),r.jsx("path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"}),r.jsx("path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"})]}),Mr=()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"8",r:"5"}),r.jsx("path",{d:"M20 21a8 8 0 1 0-16 0"})]}),we=[{id:"home",label:"Home",href:"/",icon:r.jsx(Tr,{})},{id:"dashboard",label:"Dashboard",href:"/dashboard",icon:r.jsx(Lr,{})},{id:"report",label:"Report",href:"/report-activity",icon:r.jsx(Rr,{})},{id:"admin",label:"Admin",href:"/admin",icon:r.jsx(Ur,{})},{id:"profile",label:"Profile",href:"/user-profile",icon:r.jsx(Mr,{})}];function zr({className:e}){const{theme:t,toggleDarkMode:o}=ze(),a=ee(),[d,l]=s.useState(!1),g=()=>{const h=a.pathname;return h==="/"||h==="/dashboard"?"Home":h.startsWith("/report-activity")?"Report Activity":h.startsWith("/admin")?h==="/admin"?"Admin":h.includes("/users")?"User Management":h.includes("/observations")?"Observations":h.includes("/statistics")?"Statistics":h.includes("/settings")?"Settings":h.includes("/notifications")?"Notifications":"Admin":h.startsWith("/user-profile")?"My Profile":"Elephant Watch"};s.useEffect(()=>{const h=()=>{l(window.innerWidth>=768)};return h(),window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]);const b=Ve(t,"bg-background text-onBackground");return r.jsxs("div",{className:w("flex h-screen w-full overflow-hidden",b,e),children:[d&&r.jsx(jr,{items:we,showLabels:"selected"}),r.jsxs("main",{className:w("flex-1 flex flex-col overflow-auto",d?"ml-20":"",d?"pb-4":"pb-20"),children:[r.jsx(Or,{title:g(),elevated:!0,centerTitle:!d,navigationIcon:d?void 0:r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"4",x2:"20",y1:"12",y2:"12"}),r.jsx("line",{x1:"4",x2:"20",y1:"6",y2:"6"}),r.jsx("line",{x1:"4",x2:"20",y1:"18",y2:"18"})]}),actions:[{icon:t.isDark?r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"4"}),r.jsx("path",{d:"M12 2v2"}),r.jsx("path",{d:"M12 20v2"}),r.jsx("path",{d:"m4.93 4.93 1.41 1.41"}),r.jsx("path",{d:"m17.66 17.66 1.41 1.41"}),r.jsx("path",{d:"M2 12h2"}),r.jsx("path",{d:"M20 12h2"}),r.jsx("path",{d:"m6.34 17.66-1.41 1.41"}),r.jsx("path",{d:"m19.07 4.93-1.41 1.41"})]}):r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"})}),label:t.isDark?"Switch to Light Mode":"Switch to Dark Mode",onClick:o}]}),r.jsx("div",{className:"flex-1",children:r.jsx(ve,{})})]}),!d&&r.jsx(Er,{items:we,showLabels:"always"})]})}const Vr=s.lazy(()=>j(()=>import("./Index-B5HKV0DS.js"),__vite__mapDeps([0,1,2,3,4]))),Br=s.lazy(()=>j(()=>import("./NotFound-Beh7tFLs.js"),__vite__mapDeps([5,1,2]))),Jr=s.lazy(()=>j(()=>import("./ReportActivityPage-DnjqMssQ.js"),__vite__mapDeps([6,1,2,7,4,8,9,10,11,12,3]))),Wr=s.lazy(()=>j(()=>import("./Dashboard-C4mAyzUg.js"),__vite__mapDeps([13,1,2,3,7,8,4,11,10]))),$r=s.lazy(()=>j(()=>import("./Admin-D-_tSpO9.js"),__vite__mapDeps([14,1,2,3,4]))),Fr=s.lazy(()=>j(()=>import("./Login-zopu4vRh.js"),__vite__mapDeps([15,1,2,8,4,9,10,7]))),Gr=s.lazy(()=>j(()=>import("./AdminUsers-D10H_mx_.js"),__vite__mapDeps([16,1,2,8,4,9,10,7,11,17]))),qr=s.lazy(()=>j(()=>import("./AdminObservations-0H5gCaln.js"),__vite__mapDeps([18,1,2,12,8,4,7,17,9,10]))),Yr=s.lazy(()=>j(()=>import("./AdminStatistics-DJOFT8MX.js"),__vite__mapDeps([19,1,2,7,12,4]))),Hr=s.lazy(()=>j(()=>import("./AdminSettings-BnU_8GXX.js"),__vite__mapDeps([20,1,2,7,8,4,9,21,11,17]))),Xr=s.lazy(()=>j(()=>import("./AdminNotifications-CYzSCxrx.js"),__vite__mapDeps([22,1,2,7,8,4,9,21,11]))),Kr=s.lazy(()=>j(()=>import("./UserProfilePage-CUsOUSgh.js"),__vite__mapDeps([23,1,2,3,4]))),Zr=s.lazy(()=>j(()=>import("./user-profile-edit-V1DN1th1.js"),__vite__mapDeps([24,1,2,25,4]))),Qr=s.lazy(()=>j(()=>import("./Settings-CxVqtUU9.js"),__vite__mapDeps([26,1,2,25,4]))),et=s.lazy(()=>j(()=>import("./Privacy-Dbw_Jx0E.js"),__vite__mapDeps([27,1,2,25,4]))),rt=s.lazy(()=>j(()=>import("./Help-KDGhLlGO.js"),__vite__mapDeps([28,1,2,25,4])));class tt extends s.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,o){console.error("Error caught by ErrorBoundary:",t,o)}render(){return this.state.hasError?this.props.fallback:this.props.children}}const ot=new Ke,st=Ze([{path:"/login",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Fr,{})})},{path:"/",element:r.jsx(kr,{}),children:[{element:r.jsx(zr,{}),children:[{index:!0,element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Vr,{})})},{path:"report-activity",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Jr,{})})},{path:"dashboard",element:r.jsx(tt,{fallback:r.jsx("div",{children:"Failed to load dashboard. Please try refreshing the page."}),children:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Wr,{})})})},{path:"admin",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx($r,{})})},{path:"admin/users",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Gr,{})})},{path:"admin/observations",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(qr,{})})},{path:"admin/statistics",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Yr,{})})},{path:"admin/settings",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Hr,{})})},{path:"admin/notifications",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Xr,{})})},{path:"user-profile",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Kr,{})})},{path:"user-profile/edit",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Zr,{})})},{path:"settings",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Qr,{})})},{path:"privacy",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(et,{})})},{path:"help",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(rt,{})})}]}]},{path:"*",element:r.jsx(s.Suspense,{fallback:r.jsx(E,{}),children:r.jsx(Br,{})})}]),at=({children:e})=>r.jsx(Ar,{children:r.jsx(Qe,{client:ot,children:r.jsx(mr,{children:r.jsxs(Sr,{children:[r.jsx(gr,{}),r.jsx(hr,{}),e]})})})}),nt=()=>r.jsx(er,{router:st}),it=()=>r.jsx(at,{children:r.jsx(nt,{})});window.CESIUM_BASE_URL="/cesium";rr.createRoot(document.getElementById("root")).render(r.jsx(it,{}));export{Ue as A,ze as a,Ve as b,w as c,ut as d,br as g,z as s,lr as t,_r as u};
//# sourceMappingURL=index-frrA2ug8.js.map
