import{r as m,j as e,F as Se,a6 as Ee,E as te,a9 as ae,aa as Ae,M as q,ab as Ge,ac as qe,ad as Ke,ae as Q,af as De,ag as Z,ah as L,ai as M,aj as J,ak as B,al as O,am as k,an as P,ao as G,ap as Fe,R as $e,aq as Ue,ar as Ve,D as Y,w as ze,as as Re,at as He,au as We}from"./vendor-BN4GkXqm.js";import{A as F}from"./android-card-CUsbR1ml.js";import{c as ie,s as c,a as Ie}from"./index-CF756DUw.js";import{C as _,b as y,c as N,a as w,d as Qe}from"./card-C1KHSlZe.js";import{B as Ce}from"./button-BJ90T0vB.js";import{S as $,a as U,b as V,c as z,d as C}from"./select-CEOqmhIZ.js";import{L as X}from"./label-6ghtkqW1.js";import{g as Ye,L as Te,h as Le,i as Me}from"./radix-DRLsuDDF.js";const Xe=Ye,Je=m.forwardRef(({className:i,...p},f)=>e.jsx(Te,{ref:f,className:ie("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",i),...p}));Je.displayName=Te.displayName;const ee=m.forwardRef(({className:i,...p},f)=>e.jsx(Le,{ref:f,className:ie("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",i),...p}));ee.displayName=Le.displayName;const se=m.forwardRef(({className:i,...p},f)=>e.jsx(Me,{ref:f,className:ie("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",i),...p}));se.displayName=Me.displayName;function Ze({polygons:i}){const p=Fe();return m.useEffect(()=>{if(i.length>0){const f=Z.latLngBounds(i.flatMap(v=>v.coordinates));p.fitBounds(f,{padding:[50,50]})}},[i,p]),null}const es=()=>{var he,xe,ge,pe,ue,be,ve,fe,je,_e,ye,Ne,we;const[i,p]=m.useState({timeRange:"7d"}),[f,v]=m.useState(!0),[ne,A]=m.useState(!1),[H,W]=m.useState([]),[I,K]=m.useState([]),[r,E]=m.useState([]),[u,Be]=m.useState({kpiSummary:{total_activities:0,total_users:0,total_days:0,total_elephants_sighted:0,total_loss_reports:0,loss_types:[],today_activities:0},divisionStats:[],rangeStats:[],beatStats:[],observationTypes:[],heatmap:[]}),[re,R]=m.useState(null),[is,ns]=m.useState(!1),[oe,D]=m.useState([]),[le,de]=m.useState([]);m.useEffect(()=>{async function t(){v(!0);try{const{data:n,error:l}=await c.from("divisions").select("id, name").order("name");if(l)throw l;const j=(n||[]).map(x=>({id:String(x.id),name:String(x.name)}));W(j);const{data:s,error:b}=await c.from("division_polygons").select("*");if(b)throw b;const o=(s||[]).reduce((x,d)=>{try{const h=JSON.parse(d.geojson).coordinates[0].map(S=>[S[1],S[0]]);x.push({id:d.id,name:d.name||"Unnamed Division",type:"division",coordinates:h})}catch(g){console.error("Error parsing polygon data:",g)}return x},[]);D(o)}catch(n){console.error("Error in fetchDivisions:",n),R("Failed to load divisions data")}finally{v(!1)}}t()},[]),m.useEffect(()=>{async function t(){if(!i.division){K([]),E([]),D([]);return}v(!0);try{const{data:n,error:l}=await c.from("ranges").select("new_id, name, new_division_id").eq("new_division_id",i.division).order("name");if(l)throw l;const j=(n||[]).map(o=>({id:String(o.new_id),name:String(o.name)}));K(j),E([]);const{data:s,error:b}=await c.from("division_polygons").select("*").eq("new_division_id",i.division).single();if(!b&&s)try{const o=s,d=JSON.parse(o.geojson).coordinates[0].map(g=>[g[1],g[0]]);D([{id:o.id,name:o.name||"Unnamed Division",type:"division",coordinates:d}])}catch(o){console.error("Error parsing polygon data:",o),D([])}else D([])}catch(n){console.error("Error in fetchRanges:",n),R("Failed to load ranges data")}finally{v(!1)}}t()},[i.division]),m.useEffect(()=>{async function t(){if(!i.range||!i.division){E([]);return}v(!0);const{data:n,error:l}=await c.from("beats").select(`
          new_id,
          name,
          new_range_id,
          new_division_id
        `).eq("new_range_id",i.range).eq("new_division_id",i.division).order("name");if(l){console.error("Error fetching beats:",l);return}const j=(n||[]).map(s=>({id:s.new_id,name:s.name}));E(j),v(!1)}t()},[i.range,i.division]);const ce=async()=>{v(!0);try{const{data:t,error:n}=await c.from("v_dashboard_kpi_summary").select("*").single();if(n)throw n;const{data:l,error:j}=await c.from("v_dashboard_division_stats").select("*");if(j)throw j;const{data:s,error:b}=await c.from("v_dashboard_range_stats").select("*");if(b)throw b;const{data:o,error:x}=await c.from("v_dashboard_beat_stats").select("*");if(x)throw x;const{data:d,error:g}=await c.from("v_dashboard_observations_by_type").select("*");if(g)throw g;const{data:h,error:S}=await c.from("v_elephant_activity_observations_by_type").select("*");if(S)throw S;const T=(h==null?void 0:h.reduce((a,Pe)=>a+(Number(Pe.count)||0),0))||0,ke={kpiSummary:{total_activities:Number(t.total_activities)||0,total_users:Number(t.total_users)||0,total_days:Number(t.total_days)||0,total_elephants_sighted:Number(t.total_elephants_sighted)||0,total_loss_reports:T,loss_types:(h==null?void 0:h.map(a=>({type:String(a.type),count:Number(a.count)||0})))||[],today_activities:Number(t.today_activities)||0},divisionStats:(l==null?void 0:l.map(a=>({division_id:String(a.division_id),division_name:String(a.division_name),total_observations:Number(a.total_observations)||0,direct_sightings:Number(a.direct_sightings)||0,indirect_sightings:Number(a.indirect_sightings)||0,loss_reports:Number(a.loss_reports)||0,total_elephants:Number(a.total_elephants)||0,male_elephants:Number(a.male_elephants)||0,female_elephants:Number(a.female_elephants)||0,calves:Number(a.calves)||0})))||[],rangeStats:(s==null?void 0:s.map(a=>({range_id:String(a.range_id),range_name:String(a.range_name),division_id:String(a.division_id),division_name:String(a.division_name),total_observations:Number(a.total_observations)||0,direct_sightings:Number(a.direct_sightings)||0,indirect_sightings:Number(a.indirect_sightings)||0,loss_reports:Number(a.loss_reports)||0,total_elephants:Number(a.total_elephants)||0,male_elephants:Number(a.male_elephants)||0,female_elephants:Number(a.female_elephants)||0,calves:Number(a.calves)||0})))||[],beatStats:(o==null?void 0:o.map(a=>({beat_id:String(a.beat_id),beat_name:String(a.beat_name),range_id:String(a.range_id),range_name:String(a.range_name),division_id:String(a.division_id),division_name:String(a.division_name),total_observations:Number(a.total_observations)||0,direct_sightings:Number(a.direct_sightings)||0,indirect_sightings:Number(a.indirect_sightings)||0,loss_reports:Number(a.loss_reports)||0,total_elephants:Number(a.total_elephants)||0,male_elephants:Number(a.male_elephants)||0,female_elephants:Number(a.female_elephants)||0,calves:Number(a.calves)||0})))||[],observationTypes:(d==null?void 0:d.map(a=>({observation_type:String(a.observation_type),count:Number(a.count)||0})))||[],heatmap:[]};Be(ke),R(null)}catch(t){console.error("Error fetching dashboard data:",t),R("Failed to load dashboard data")}finally{v(!1)}};m.useEffect(()=>{(async()=>{try{await ce()}catch(n){console.error("Failed to load dashboard data:",n),R("Failed to load dashboard data. Some features may not be available."),v(!1)}})()},[]);const Oe=(t,n)=>{p(l=>({...l,[t]:n}))},me=async()=>{A(!0);try{await ce()}finally{A(!1)}};return m.useEffect(()=>{async function t(){if(!i.division){D([]);return}try{let n=[];const{data:l,error:j}=await c.from("division_polygons").select(`
            id,
            new_division_id,
            divisions!inner(
              name
            )
          `).eq("new_division_id",i.division).single();if(console.log("Division data:",l),console.log("Division error:",j),l)try{const{data:s,error:b}=await c.from("division_polygons").select("polygon").eq("id",l.id).single();if(b){console.error("Error fetching polygon:",b);return}const{data:o,error:x}=await c.rpc("st_asgeojson",{geom:s.polygon});if(x){console.error("Error converting to GeoJSON:",x);return}const d=typeof o=="string"?JSON.parse(o):o&&typeof o=="object"?o:null;console.log("Parsed division GeoJSON:",d),n.push({id:l.id,name:typeof l.divisions.name=="string"?l.divisions.name:l.divisions.name!=null?String(l.divisions.name):"",coordinates:d&&d.coordinates?d.coordinates[0].map(([g,h])=>[h,g]):[],type:"division"})}catch(s){console.error("Error processing division polygon:",s)}if(i.range){const{data:s,error:b}=await c.from("range_polygons").select(`
              id,
              new_range_id,
              ranges!inner(
                name
              )
            `).eq("new_range_id",i.range).single();if(console.log("Range data:",s),console.log("Range error:",b),s)try{const{data:o,error:x}=await c.from("range_polygons").select("polygon").eq("id",s.id).single();if(x){console.error("Error fetching polygon:",x);return}const{data:d,error:g}=await c.rpc("st_asgeojson",{geom:o.polygon});if(g){console.error("Error converting to GeoJSON:",g);return}const h=typeof d=="string"?JSON.parse(d):d&&typeof d=="object"?d:null;console.log("Parsed range GeoJSON:",h),n.push({id:s.id,name:typeof s.ranges.name=="string"?s.ranges.name:s.ranges.name!=null?String(s.ranges.name):"",coordinates:h&&h.coordinates?h.coordinates[0].map(([S,T])=>[T,S]):[],type:"range"})}catch(o){console.error("Error processing range polygon:",o)}}if(i.beat){const{data:s,error:b}=await c.from("beat_polygons").select(`
              id,
              new_beat_id,
              beats!inner(
                name
              )
            `).eq("new_beat_id",i.beat).single();if(console.log("Beat data:",s),console.log("Beat error:",b),s)try{const{data:o,error:x}=await c.from("beat_polygons").select("polygon").eq("id",s.id).single();if(x){console.error("Error fetching polygon:",x);return}const{data:d,error:g}=await c.rpc("st_asgeojson",{geom:o.polygon});if(g){console.error("Error converting to GeoJSON:",g);return}const h=typeof d=="string"?JSON.parse(d):d&&typeof d=="object"?d:null;console.log("Parsed beat GeoJSON:",h),n.push({id:s.id,name:typeof s.beats.name=="string"?s.beats.name:s.beats.name!=null?String(s.beats.name):"",coordinates:h&&h.coordinates?h.coordinates[0].map(([S,T])=>[T,S]):[],type:"beat"})}catch(o){console.error("Error processing beat polygon:",o)}}console.log("Final polygons array:",n),D(n)}catch(n){console.error("Error fetching polygon data:",n)}}t()},[i.division,i.range,i.beat]),m.useEffect(()=>{async function t(){try{const{data:n,error:l}=await c.from("activity_observation").select("id,latitude,longitude,observation_type,activity_date,activity_time,total_elephants,male_elephants,female_elephants,unknown_elephants,calves,indirect_sighting_type,loss_type,compass_bearing,photo_url,created_at,updated_at,division_id,range_id,division_name,range_name,beat_name").order("created_at",{ascending:!1});if(l)throw console.error("Error fetching activity markers:",l),l;const j=n.filter(s=>s.latitude&&s.longitude&&s.observation_type).map(s=>({id:typeof s.id=="string"?s.id:s.id!=null?String(s.id):"",latitude:typeof s.latitude=="number"?s.latitude:s.latitude!=null&&!isNaN(Number(s.latitude))?Number(s.latitude):0,longitude:typeof s.longitude=="number"?s.longitude:s.longitude!=null&&!isNaN(Number(s.longitude))?Number(s.longitude):0,observation_type:typeof s.observation_type=="string"?s.observation_type:s.observation_type!=null?String(s.observation_type):"",activity_date:typeof s.activity_date=="string"?s.activity_date:s.activity_date!=null?String(s.activity_date):"",activity_time:typeof s.activity_time=="string"?s.activity_time:s.activity_time!=null?String(s.activity_time):"",total_elephants:typeof s.total_elephants=="number"?s.total_elephants:s.total_elephants!=null&&!isNaN(Number(s.total_elephants))?Number(s.total_elephants):0,male_elephants:typeof s.male_elephants=="number"?s.male_elephants:s.male_elephants!=null&&!isNaN(Number(s.male_elephants))?Number(s.male_elephants):0,female_elephants:typeof s.female_elephants=="number"?s.female_elephants:s.female_elephants!=null&&!isNaN(Number(s.female_elephants))?Number(s.female_elephants):0,unknown_elephants:typeof s.unknown_elephants=="number"?s.unknown_elephants:s.unknown_elephants!=null&&!isNaN(Number(s.unknown_elephants))?Number(s.unknown_elephants):0,calves:typeof s.calves=="number"?s.calves:s.calves!=null&&!isNaN(Number(s.calves))?Number(s.calves):0,indirect_sighting_type:s.indirect_sighting_type!=null?String(s.indirect_sighting_type):void 0,loss_type:s.loss_type!=null?String(s.loss_type):void 0,compass_bearing:s.compass_bearing!=null&&!isNaN(Number(s.compass_bearing))?Number(s.compass_bearing):void 0,photo_url:s.photo_url!=null?String(s.photo_url):void 0,created_at:typeof s.created_at=="string"?s.created_at:s.created_at!=null&&s.created_at!==void 0?String(s.created_at):"",updated_at:typeof s.updated_at=="string"?s.updated_at:s.updated_at!=null&&s.updated_at!==void 0?String(s.updated_at):"",division_id:typeof s.division_id=="string"?s.division_id:s.division_id!=null&&s.division_id!==void 0?String(s.division_id):"",range_id:typeof s.range_id=="string"?s.range_id:s.range_id!=null&&s.range_id!==void 0?String(s.range_id):"",division_name:typeof s.division_name=="string"?s.division_name:s.division_name!=null&&s.division_name!==void 0?String(s.division_name):"",range_name:typeof s.range_name=="string"?s.range_name:s.range_name!=null&&s.range_name!==void 0?String(s.range_name):"",beat_name:typeof s.beat_name=="string"?s.beat_name:s.beat_name!=null&&s.beat_name!==void 0?String(s.beat_name):""}));de(j)}catch(n){console.error("Error fetching activity markers:",n),de([])}}t()},[]),f?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Se,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{children:"Loading dashboard data..."})]})}):re?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ee,{className:"h-8 w-8 text-red-500 mx-auto mb-4"}),e.jsxs("p",{className:"text-red-500",children:["Error: ",re]}),e.jsx(Ce,{onClick:me,className:"mt-4",children:"Try Again"})]})}):e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs($,{value:i.timeRange,onValueChange:t=>Oe("timeRange",t),children:[e.jsx(U,{className:"w-[180px] bg-white border-gray-200 shadow-sm hover:border-blue-500 transition-colors",children:e.jsx(V,{placeholder:"Select time range"})}),e.jsxs(z,{children:[e.jsx(C,{value:"24h",children:"Last 24 Hours"}),e.jsx(C,{value:"7d",children:"Last 7 Days"}),e.jsx(C,{value:"30d",children:"Last 30 Days"}),e.jsx(C,{value:"90d",children:"Last 90 Days"})]})]}),e.jsxs(Ce,{onClick:me,className:"bg-gradient-to-r from-blue-600 to-green-600 text-white hover:from-blue-700 hover:to-green-700 shadow-sm",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(_,{className:"bg-gradient-to-br from-blue-100 to-blue-50 shadow-lg rounded-2xl hover:scale-105 hover:shadow-xl transition-all duration-300 border-0",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(N,{className:"text-base font-semibold text-blue-700",children:"Total Activities"}),e.jsx("div",{className:"bg-blue-200 p-2 rounded-full",children:e.jsx(te,{className:"h-5 w-5 text-blue-600"})})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-3xl font-extrabold text-blue-900",children:((he=u.kpiSummary)==null?void 0:he.total_activities)||0}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Across all divisions"})]})]}),e.jsxs(_,{className:"bg-gradient-to-br from-green-100 to-green-50 shadow-lg rounded-2xl hover:scale-105 hover:shadow-xl transition-all duration-300 border-0",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(N,{className:"text-base font-semibold text-green-700",children:"Active Users"}),e.jsx("div",{className:"bg-green-200 p-2 rounded-full",children:e.jsx(ae,{className:"h-5 w-5 text-green-600"})})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-3xl font-extrabold text-green-900",children:((xe=u.kpiSummary)==null?void 0:xe.total_users)||0}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Total registered users"})]})]}),e.jsxs(_,{className:"bg-gradient-to-br from-red-100 to-red-50 shadow-lg rounded-2xl hover:scale-105 hover:shadow-xl transition-transform",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(N,{className:"text-base font-semibold text-red-700",children:"Total Loss"}),e.jsx("div",{className:"bg-red-200 p-2 rounded-full",children:e.jsx(Ee,{className:"h-5 w-5 text-red-600"})})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-3xl font-extrabold text-red-900",children:((ge=u.kpiSummary)==null?void 0:ge.total_loss_reports)||0}),e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Total loss reports"})]})]}),e.jsxs(_,{className:"bg-gradient-to-br from-purple-100 to-purple-50 shadow-lg rounded-2xl hover:scale-105 hover:shadow-xl transition-transform",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(N,{className:"text-base font-semibold text-purple-700",children:"Today's Activities"}),e.jsx("div",{className:"bg-purple-200 p-2 rounded-full",children:e.jsx(Ae,{className:"h-5 w-5 text-purple-600"})})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-3xl font-extrabold text-purple-900",children:((pe=u.kpiSummary)==null?void 0:pe.today_activities)||0}),e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Activities in last 24 hours"})]})]})]}),e.jsxs(_,{className:"border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(y,{className:"bg-gradient-to-r from-blue-50 to-green-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx(N,{className:"text-xl font-semibold text-gray-900",children:"Activity Map"}),e.jsx(Qe,{children:"Geographic distribution of elephant activities"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(X,{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-blue-600"}),"Division"]}),e.jsxs($,{value:i.division||"",onValueChange:t=>{p(n=>({...n,division:t,range:void 0,beat:void 0}))},children:[e.jsx(U,{className:"w-full bg-white border-gray-200 shadow-sm hover:border-blue-500 transition-colors",children:e.jsx(V,{placeholder:"Select Division"})}),e.jsx(z,{children:H.map(t=>e.jsx(C,{value:t.id,children:t.name},t.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(X,{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-blue-600"}),"Range"]}),e.jsxs($,{value:i.range||"",onValueChange:t=>{p(n=>({...n,range:t,beat:void 0}))},disabled:!i.division,children:[e.jsx(U,{className:"w-full bg-white border-gray-200 shadow-sm hover:border-blue-500 transition-colors disabled:opacity-50",children:e.jsx(V,{placeholder:"Select Range"})}),e.jsx(z,{children:I.map(t=>e.jsx(C,{value:t.id,children:t.name},t.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(X,{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-blue-600"}),"Beat"]}),e.jsxs($,{value:i.beat||"",onValueChange:t=>{p(n=>({...n,beat:t}))},disabled:!i.range,children:[e.jsx(U,{className:"w-full bg-white border-gray-200 shadow-sm hover:border-blue-500 transition-colors disabled:opacity-50",children:e.jsx(V,{placeholder:"Select Beat"})}),e.jsx(z,{children:r.map(t=>e.jsx(C,{value:t.id,children:t.name},t.id))})]})]})]})]})}),e.jsxs(w,{className:"p-6",children:[e.jsx("div",{className:"h-[500px] rounded-lg overflow-hidden border border-gray-200",children:e.jsxs(Ge,{center:[10.8505,76.2711],zoom:8,style:{width:"100%",height:"100%"},children:[e.jsx(qe,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),e.jsx(Ze,{polygons:oe}),oe.map(t=>(console.log("Rendering polygon:",t),e.jsx(Ke,{positions:t.coordinates,pathOptions:{color:t.type==="division"?"#2563eb":t.type==="range"?"#f97316":"#6b7280",fillColor:t.type==="division"?"#3b82f6":t.type==="range"?"#fb923c":"#9ca3af",fillOpacity:.2,weight:2},children:e.jsx(Q,{children:e.jsxs("div",{className:"p-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.type.charAt(0).toUpperCase()+t.type.slice(1)," Boundary"]})]})})},t.id))),u.heatmap.map((t,n)=>e.jsx(De,{position:[t.lat,t.lng],icon:Z.divIcon({className:"custom-marker",html:'<div class="w-4 h-4 rounded-full bg-blue-500 border-2 border-white shadow-lg"></div>',iconSize:[16,16]}),children:e.jsx(Q,{children:e.jsxs("div",{className:"p-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.division_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.observation_count," observations",t.total_elephants_seen>0&&` • ${t.total_elephants_seen} elephants seen`]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last observation: ",new Date(t.last_observation_date).toLocaleDateString()]})]})})},n)),le.map(t=>e.jsx(De,{position:[t.latitude,t.longitude],icon:Z.divIcon({className:"custom-marker",html:`
                      <div style="
                        width: 24px;
                        height: 24px;
                        background-color: #22c55e;
                        border: 3px solid white;
                        border-radius: 50%;
                        box-shadow: 0 0 10px rgba(0,0,0,0.3);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                      ">
                        <div style="
                          width: 8px;
                          height: 8px;
                          background-color: white;
                          border-radius: 50%;
                        "></div>
                      </div>
                    `,iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]}),children:e.jsx(Q,{children:e.jsxs("div",{className:"p-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.observation_type}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.activity_date," ",t.activity_time]}),t.total_elephants&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Total Elephants: ",t.total_elephants,t.male_elephants&&` (${t.male_elephants} male)`,t.female_elephants&&` (${t.female_elephants} female)`,t.calves&&` (${t.calves} calves)`]}),t.indirect_sighting_type&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Evidence: ",t.indirect_sighting_type]}),t.loss_type&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Loss Type: ",t.loss_type]})]})})},t.id))]})}),e.jsx("div",{className:"mt-4 flex items-center justify-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-600 border-2 border-white shadow-md flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Activity Points (",le.length,")"]})]})})]})]}),e.jsxs(Xe,{defaultValue:"overview",className:"space-y-8",children:[e.jsxs(Je,{className:"bg-white p-2 rounded-xl shadow-md flex gap-4",children:[e.jsx(ee,{value:"overview",className:"data-[state=active]:bg-blue-100 data-[state=active]:text-blue-800 font-semibold px-6 py-2 rounded-lg transition-all duration-300",children:"Overview"}),e.jsx(ee,{value:"activity",className:"data-[state=active]:bg-blue-100 data-[state=active]:text-blue-800 font-semibold px-6 py-2 rounded-lg transition-all duration-300",children:"Activity"})]}),e.jsxs(se,{value:"overview",className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(_,{className:"bg-white shadow-lg rounded-2xl border-0",children:[e.jsx(y,{children:e.jsx(N,{className:"text-lg font-bold text-gray-900",children:"Observations by Type"})}),e.jsx(w,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(M,{data:u.observationTypes,barCategoryGap:24,children:[e.jsx(J,{strokeDasharray:"3 3",className:"stroke-gray-200"}),e.jsx(B,{dataKey:"observation_type",className:"text-sm"}),e.jsx(O,{className:"text-sm"}),e.jsx(k,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.75rem",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(P,{}),e.jsx(G,{dataKey:"count",fill:"#4f46e5",radius:[8,8,0,0],isAnimationActive:!0})]})})})})]}),e.jsxs(_,{className:"bg-white shadow-md rounded-2xl",children:[e.jsx(y,{children:e.jsx(N,{className:"text-lg font-bold text-blue-900",children:"Most Active Areas"})}),e.jsx(w,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Most Active Division"}),e.jsx("p",{className:"text-2xl font-extrabold text-blue-900 mt-1",children:((be=(ue=u.divisionStats)==null?void 0:ue[0])==null?void 0:be.division_name)||"N/A"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-blue-700",children:"Observations"}),e.jsx("p",{className:"text-2xl font-extrabold text-blue-900 mt-1",children:((fe=(ve=u.divisionStats)==null?void 0:ve[0])==null?void 0:fe.total_observations)||0})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Most Active Range"}),e.jsx("p",{className:"text-2xl font-extrabold text-blue-900 mt-1",children:((_e=(je=u.rangeStats)==null?void 0:je[0])==null?void 0:_e.range_name)||"N/A"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-blue-700",children:"Observations"}),e.jsx("p",{className:"text-2xl font-extrabold text-blue-900 mt-1",children:((Ne=(ye=u.rangeStats)==null?void 0:ye[0])==null?void 0:Ne.total_observations)||0})]})]})]})})]})]}),e.jsxs(_,{className:"bg-white shadow-md rounded-2xl",children:[e.jsx(y,{children:e.jsx(N,{className:"text-lg font-bold text-red-700",children:"Loss Reports Summary"})}),e.jsx(w,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(M,{data:u.divisionStats,barCategoryGap:24,children:[e.jsx(J,{strokeDasharray:"3 3",className:"stroke-gray-200"}),e.jsx(B,{dataKey:"division_name",className:"text-sm"}),e.jsx(O,{className:"text-sm"}),e.jsx(k,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(P,{}),e.jsx(G,{dataKey:"loss_reports",fill:"#ef4444",radius:[8,8,0,0],isAnimationActive:!0})]})})})})]})]}),e.jsxs(se,{value:"activity",className:"space-y-8",children:[e.jsxs(_,{className:"bg-white shadow-md rounded-2xl",children:[e.jsx(y,{children:e.jsx(N,{className:"text-lg font-bold text-blue-900",children:"Activity by Division"})}),e.jsx(w,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(M,{data:u.divisionStats,barCategoryGap:24,children:[e.jsx(J,{strokeDasharray:"3 3",className:"stroke-gray-200"}),e.jsx(B,{dataKey:"division_name",className:"text-sm"}),e.jsx(O,{className:"text-sm"}),e.jsx(k,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(P,{}),e.jsx(G,{dataKey:"total_observations",fill:"#4f46e5",radius:[8,8,0,0],isAnimationActive:!0})]})})})})]}),e.jsxs(_,{className:"bg-white shadow-md rounded-2xl",children:[e.jsx(y,{children:e.jsx(N,{className:"text-lg font-bold text-blue-900",children:"Activity by Range"})}),e.jsx(w,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(M,{data:u.rangeStats,barCategoryGap:24,children:[e.jsx(J,{strokeDasharray:"3 3",className:"stroke-gray-200"}),e.jsx(B,{dataKey:"range_name",className:"text-sm"}),e.jsx(O,{className:"text-sm"}),e.jsx(k,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(P,{}),e.jsx(G,{dataKey:"total_observations",fill:"#4f46e5",radius:[8,8,0,0],isAnimationActive:!0})]})})})})]}),e.jsxs(_,{className:"bg-white shadow-md rounded-2xl",children:[e.jsx(y,{children:e.jsx(N,{className:"text-lg font-bold text-red-700",children:"Loss Reports by Type"})}),e.jsx(w,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(M,{data:((we=u.kpiSummary)==null?void 0:we.loss_types)||[],barCategoryGap:24,children:[e.jsx(J,{strokeDasharray:"3 3",className:"stroke-gray-200"}),e.jsx(B,{dataKey:"type",className:"text-sm"}),e.jsx(O,{className:"text-sm"}),e.jsx(k,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(P,{}),e.jsx(G,{dataKey:"count",fill:"#ef4444",radius:[8,8,0,0],isAnimationActive:!0})]})})})})]})]})]})]})},ss=[{label:"Active Elephants",value:"24",icon:e.jsx(te,{className:"h-5 w-5 text-emerald-500"}),change:"+12%",changeType:"positive"},{label:"Alerts Today",value:"5",icon:e.jsx(Re,{className:"h-5 w-5 text-amber-500"}),change:"-2",changeType:"negative"},{label:"Ranger Patrols",value:"8",icon:e.jsx(ae,{className:"h-5 w-5 text-blue-500"}),change:"+3",changeType:"positive"},{label:"Areas Monitored",value:"15",icon:e.jsx(q,{className:"h-5 w-5 text-violet-500"}),change:"0",changeType:"neutral"}],ts=[{label:"New Sighting",icon:e.jsx(He,{className:"h-5 w-5"}),href:"/report",bgColor:"bg-emerald-100 dark:bg-emerald-900/30",textColor:"text-emerald-600 dark:text-emerald-400"},{label:"View Map",icon:e.jsx(q,{className:"h-5 w-5"}),href:"/map",bgColor:"bg-blue-100 dark:bg-blue-900/30",textColor:"text-blue-600 dark:text-blue-400"},{label:"Reports",icon:e.jsx(We,{className:"h-5 w-5"}),href:"/reports",bgColor:"bg-purple-100 dark:bg-purple-900/30",textColor:"text-purple-600 dark:text-purple-400"},{label:"Schedule",icon:e.jsx(Ae,{className:"h-5 w-5"}),href:"/schedule",bgColor:"bg-amber-100 dark:bg-amber-900/30",textColor:"text-amber-600 dark:text-amber-400"}],as=[{id:1,type:"sighting",title:"New elephant sighting",description:"Herd of 5 elephants spotted near the river",time:"10 minutes ago",icon:e.jsx(te,{className:"h-4 w-4 text-emerald-500"})},{id:2,type:"alert",title:"Security alert",description:"Unusual movement detected in zone 4B",time:"1 hour ago",icon:e.jsx(Re,{className:"h-4 w-4 text-amber-500"})},{id:3,type:"patrol",title:"Patrol completed",description:"Ranger team completed morning patrol",time:"2 hours ago",icon:e.jsx(ae,{className:"h-4 w-4 text-blue-500"})}];function ps(){const{theme:i,toggleDarkMode:p}=Ie(),f=i.isDark,v=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),ne=r=>{console.log("Action:",r)},[A,H]=$e.useState(!0),W=()=>e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:ss.map((r,E)=>e.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.1},children:e.jsx(F,{className:"h-full",children:e.jsxs("div",{className:"flex items-start justify-between p-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:r.label}),e.jsx("p",{className:"mt-1 text-2xl font-semibold text-slate-900 dark:text-white",children:r.value}),e.jsxs("div",{className:`mt-2 flex items-center text-sm ${r.changeType==="positive"?"text-emerald-600 dark:text-emerald-400":r.changeType==="negative"?"text-rose-600 dark:text-rose-400":"text-slate-500 dark:text-slate-400"}`,children:[r.change,r.changeType==="positive"&&e.jsx("svg",{className:"ml-1 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),r.changeType==="negative"&&e.jsx("svg",{className:"ml-1 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),e.jsx("div",{className:`p-2 rounded-lg ${r.changeType==="positive"?"bg-emerald-100 dark:bg-emerald-900/30":r.changeType==="negative"?"bg-rose-100 dark:bg-rose-900/30":"bg-slate-100 dark:bg-slate-800/50"}`,children:r.icon})]})})},r.label))}),I=()=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-medium text-slate-900 dark:text-white mb-4",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:ts.map((r,E)=>e.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4+E*.1},whileHover:{y:-2},children:e.jsxs(ze,{to:r.href,className:`flex flex-col items-center justify-center p-6 rounded-xl transition-all ${r.bgColor} ${r.textColor} hover:shadow-md`,onClick:()=>ne(r.label),children:[e.jsx("div",{className:"p-3 rounded-full bg-white/20 mb-3",children:r.icon}),e.jsx("span",{className:"text-sm font-medium",children:r.label})]})},r.label))})]}),K=()=>e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-slate-900 dark:text-white mb-4",children:"Recent Activity"}),e.jsx("div",{className:"space-y-4",children:as.map(r=>e.jsxs(Y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},className:"flex items-start p-4 rounded-xl bg-white dark:bg-slate-800/50 shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("div",{className:`p-2 rounded-lg ${r.type==="sighting"?"bg-emerald-100 dark:bg-emerald-900/30":r.type==="alert"?"bg-amber-100 dark:bg-amber-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:r.icon}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("h3",{className:"font-medium text-slate-900 dark:text-white",children:r.title}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:r.description}),e.jsx("p",{className:"mt-1 text-xs text-slate-400 dark:text-slate-500",children:r.time})]})]},r.id))})]});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-blue-50/30 dark:from-slate-900 dark:to-slate-950/80 p-6",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Elephant Watch Dashboard"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:v})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-4 sm:mt-0",children:[e.jsx("button",{onClick:p,className:"p-2 rounded-full bg-white dark:bg-slate-800 shadow-sm hover:shadow-md transition-shadow","aria-label":"Toggle dark mode",children:f?e.jsx(Ue,{className:"h-5 w-5 text-amber-400"}):e.jsx(Ve,{className:"h-5 w-5 text-slate-700"})}),e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-medium",children:"U"})]})]}),e.jsxs("main",{className:"space-y-8",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>H(!A),className:`px-4 py-2 rounded-lg transition-all ${f?"bg-slate-700 text-white hover:bg-slate-600":"bg-blue-100 text-blue-800 hover:bg-blue-200"}`,children:A?"Show Simple Dashboard":"Show Enhanced Dashboard"})}),A?e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-lg p-6",children:e.jsx(es,{})}):e.jsxs(e.Fragment,{children:[W(),I(),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:K()}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-slate-900 dark:text-white mb-4",children:"System Status"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900 dark:text-white",children:"Camera System"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"All cameras operational"})]}),e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-emerald-500"})]})}),e.jsx(F,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900 dark:text-white",children:"Sensors"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"24/25 active"})]}),e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-amber-500"})]})}),e.jsx(F,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900 dark:text-white",children:"Network"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Stable connection"})]}),e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-emerald-500"})]})})]})]})]})]})]}),e.jsx("footer",{className:"mt-12 text-center text-sm text-slate-500 dark:text-slate-400",children:e.jsxs("p",{children:["© ",new Date().getFullYear()," Elephant Watch. All rights reserved."]})})]})}export{ps as default};
//# sourceMappingURL=Dashboard-DuZWEZBv.js.map
