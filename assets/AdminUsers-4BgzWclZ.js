import{j as e,b as se}from"./ui-DUKcQzV-.js";import{a as c}from"./vendor-C4vCQKbn.js";import{c as S,b as re,u as ae,k as y,j as x,B as _,L as q,D as te,o as ne,p as ie,q as oe,r as le,t as de}from"./index-D06kCfwG.js";import{I as T}from"./input-PBczrgJI.js";import{L as j}from"./label-Dr6kIi7P.js";import{C as ce,a as ue,b as me,c as he}from"./card-CypzqOhv.js";import{S as k,a as R,b as F,c as D,d as g}from"./select-rBkzWHzS.js";import{T as ge,a as xe,b as $,c as N,d as fe,e as C}from"./table-DON6ooQa.js";import"./supabase-BA4zP0Ex.js";import"./index-BozIbYBo.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=S("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=S("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=S("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=S("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=S("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=S("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),_e=se("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function X({className:f,variant:v,...b}){return e.jsx("div",{className:re(_e({variant:v}),f),...b})}const Ne=(f,v)=>{switch(v.type){case"FETCH_START":return{...f,loading:!0,error:null};case"FETCH_SUCCESS":return{...f,loading:!1,users:v.payload,lastFetched:Date.now()};case"FETCH_ERROR":return{...f,loading:!1,error:v.error};default:return f}};function Ue(){const[f,v]=c.useState(""),[b,M]=c.useState(!1),[A,K]=c.useState([]),[Z,B]=c.useState([]),[J,Y]=c.useState([]),[O,H]=c.useState(!1),[w,z]=c.useState(null),[L,P]=c.useState(!1),{user:G}=ae(),I=c.useRef(null),[h,U]=c.useReducer(Ne,{users:[],loading:!0,error:null,lastFetched:null}),[r,p]=c.useState({email:"",password:"",first_name:"",last_name:"",role:"data_collector",position:"Ranger",division_id:"",range_id:"",beat_id:""});c.useEffect(()=>{if(!b)return;let s=!0;const a=new AbortController,i=setTimeout(async()=>{try{const{data:l,error:n}=await y.from("divisions").select("id, name").order("name").abortSignal(a.signal);if(!s)return;if(n)throw n;l&&K(l)}catch(l){const n=l;n.name!=="AbortError"&&(console.error("Error fetching divisions:",n),x.error("Failed to load divisions"))}},100);return()=>{s=!1,a.abort(),clearTimeout(i)}},[b]),c.useEffect(()=>{let s=!0;if(!(b&&r.division_id&&["Ranger","Guard"].includes(r.position))){s&&(B([]),z(null));return}async function o(){if(s){H(!0),z(null);try{const{data:l,error:n}=await y.from("ranges").select("new_id, name, new_division_id").eq("new_division_id",r.division_id).order("name");if(!s)return;if(n)throw n;const u=l.map(d=>({id:d.new_id,name:d.name}));B(u)}catch(l){console.error("Error fetching ranges:",l),s&&(z("Failed to load ranges. Please try again."),x.error("Failed to load ranges"))}finally{s&&H(!1)}}}const i=setTimeout(o,300);return()=>{s=!1,clearTimeout(i)}},[b,r.division_id,r.position]),c.useEffect(()=>{let s=!0;const a=new AbortController;if(!(b&&r.range_id&&r.position==="Guard")){Y([]);return}const l=setTimeout(async()=>{try{const{data:n,error:u}=await y.from("beats").select("new_id, name, new_range_id, new_division_id").eq("new_range_id",r.range_id).eq("new_division_id",r.division_id).order("name").abortSignal(a.signal);if(!s)return;if(u)throw u;if(n){const d=n.map(t=>({id:t.new_id,name:t.name}));Y(d)}}catch(n){const u=n;u.name!=="AbortError"&&(console.error("Error fetching beats:",u),x.error("Failed to load beats"))}},300);return()=>{s=!1,a.abort(),clearTimeout(l)}},[b,r.range_id,r.position,r.division_id]);const E=c.useCallback(async()=>{var a;I.current&&I.current.abort();const s=new AbortController;if(I.current=s,!(h.lastFetched&&Date.now()-h.lastFetched<3e4)){U({type:"FETCH_START"});try{const o=setTimeout(()=>{s.abort("Request timed out")},1e4),{data:i,error:l}=await y.auth.getSession();if(l||!i.session)throw new Error((l==null?void 0:l.message)||"Not authenticated");const n=await fetch("https://vfsyjvjghftfebvxyjba.supabase.co/functions/v1/get-users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i.session.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZmc3lqdmpnaGZ0ZmVidnh5amJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNTU3MjYsImV4cCI6MjA2NDYzMTcyNn0.td6SnbD51RuNG_tTuKSC7Jwcz_lUk1tcrcNTwC3OLxc"},body:JSON.stringify({}),signal:s.signal});if(clearTimeout(o),!n.ok){const t=await n.json().catch(()=>({}));throw new Error(((a=t.error)==null?void 0:a.message)||"Failed to fetch users")}const u=await n.json();if(!u.users)throw new Error("Invalid response format from server");const d=u.users.map(t=>({...t,user_region_assignments:t.user_region_assignments||[]}));U({type:"FETCH_SUCCESS",payload:d})}catch(o){if(o.name==="AbortError")return;console.error("Error fetching users:",o);const i=o.message||"Failed to load users";U({type:"FETCH_ERROR",error:i}),x.error(i)}}},[h.lastFetched]);c.useEffect(()=>{E();const s=setInterval(E,5*60*1e3);return()=>{I.current&&I.current.abort(),clearInterval(s)}},[E]);const Q=async s=>{var a;if(s.preventDefault(),!r.email||!r.password||!r.first_name||!r.last_name||!r.role||!r.position){x.error("Please fill in all required fields");return}if(["DFO","Ranger","Guard"].includes(r.position)&&!r.division_id){x.error("Please select a division");return}if(["Ranger","Guard"].includes(r.position)&&!r.range_id){x.error("Please select a range");return}if(r.position==="Guard"&&!r.beat_id){x.error("Please select a beat");return}P(!0);try{const o={email:r.email,password:r.password,user_metadata:{first_name:r.first_name,last_name:r.last_name,role:r.role,position:r.position}},i={first_name:r.first_name,last_name:r.last_name,email:r.email,role:r.role,position:r.position,status:"active",created_by:G==null?void 0:G.id};r.position==="DFO"&&r.division_id&&(i.division_id=r.division_id),r.position==="Ranger"&&r.division_id&&r.range_id&&(i.division_id=r.division_id,i.range_id=r.range_id),r.position==="Guard"&&r.division_id&&r.range_id&&r.beat_id&&(i.division_id=r.division_id,i.range_id=r.range_id,i.beat_id=r.beat_id),console.log("Calling create-user function with:",{userData:{...o,password:"[REDACTED]"},assignments:i});const{data:{session:l},error:n}=await y.auth.getSession(),u=l==null?void 0:l.access_token;if(!u||n)throw new Error((n==null?void 0:n.message)||"No active session found. Please log in again.");const d=await fetch("https://vfsyjvjghftfebvxyjba.supabase.co/functions/v1/create-user",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZmc3lqdmpnaGZ0ZmVidnh5amJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNTU3MjYsImV4cCI6MjA2NDYzMTcyNn0.td6SnbD51RuNG_tTuKSC7Jwcz_lUk1tcrcNTwC3OLxc"},body:JSON.stringify({userData:o,assignments:i})});console.log("Raw response status:",d.status,d.statusText);let t;try{t=await d.json(),console.log("Response data:",t)}catch{const ee=await d.text();throw console.error("Error parsing response. Raw response:",ee),new Error("Invalid response from server")}if(!d.ok){console.error("Error response:",t);const m=((a=t==null?void 0:t.error)==null?void 0:a.message)||(t==null?void 0:t.message)||`Request failed with status ${d.status}`;throw new Error(m)}x.success("User created successfully"),P(!1),M(!1),p({email:"",password:"",first_name:"",last_name:"",role:"data_collector",position:"Ranger",division_id:"",range_id:"",beat_id:""}),await E()}catch(o){console.error("Error creating user:",o);const i=o.message||"Failed to create user. Please try again.";x.error(i),P(!1)}finally{setLoading(!1)}},W=async s=>{if(console.log("handleDeleteUser called with:",s),!s){console.error("No user provided to delete");return}if(!window.confirm(`Are you sure you want to delete ${s.email}?`)){console.log("User cancelled deletion");return}try{console.log("Getting current session...");const{data:{session:a},error:o}=await y.auth.getSession();if(console.log("Session data:",{session:a,sessionError:o}),o)throw console.error("Error getting session:",o),new Error("Failed to verify authentication. Please try again.");if(!a)throw console.error("No active session found"),new Error("No active session. Please log in again.");const i={userId:s.id,authId:s.auth_id||s.id},n="https://vfsyjvjghftfebvxyjba.supabase.co/functions/v1/delete-user";console.log("Calling delete-user function with:",{functionUrl:n,method:"POST",body:i,hasAuthToken:!!(a!=null&&a.access_token)});const u=await fetch(n,{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZmc3lqdmpnaGZ0ZmVidnh5amJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNTU3MjYsImV4cCI6MjA2NDYzMTcyNn0.td6SnbD51RuNG_tTuKSC7Jwcz_lUk1tcrcNTwC3OLxc"}});let d=null,t=null;try{const m=await u.json();u.ok?d=m:t=m.error||{message:"Unknown error occurred"}}catch(m){console.error("Error parsing response:",m),t={message:"Failed to parse server response"}}if(console.log("delete-user function response:",{data:d,error:t}),t){console.error("Error from delete-user function:",{name:t.name,message:t.message,status:t.status,statusText:t.statusText,cause:t.cause});let m=t.message||"Failed to delete user";throw t.status===500?m="Server error while deleting user. Please try again later.":t.status===403?m="You do not have permission to delete users":t.status===401&&(m="Session expired. Please log in again."),new Error(m)}if(!d)throw new Error("No response data from server");console.log("User deleted successfully:",d),U({type:"FETCH_SUCCESS",payload:h.users.filter(m=>m.id!==s.id)}),x.success("User deleted successfully")}catch(a){const o=a instanceof Error?a.message:"Failed to delete user";console.error("Error in handleDeleteUser:",{error:a,message:o,stack:a instanceof Error?a.stack:void 0}),x.error(o)}},V=c.useMemo(()=>{if(!f)return h.users;const s=f.toLowerCase();return h.users.filter(a=>`${a.first_name} ${a.last_name}`.toLowerCase().includes(s)||a.email.toLowerCase().includes(s))},[h.users,f]);return h.loading&&h.users.length===0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"h-10 w-48 bg-muted rounded animate-pulse"}),e.jsx("div",{className:"h-10 w-32 bg-muted rounded animate-pulse"})]}),e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((s,a)=>e.jsx("div",{className:"h-16 bg-muted/50 rounded-lg animate-pulse"},a))})]}):h.error?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-destructive/10 border border-destructive text-destructive p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ye,{className:"w-5 h-5 mr-2"}),e.jsxs("span",{children:["Failed to load users: ",h.error]})]}),e.jsxs(_,{variant:"outline",size:"sm",className:"mt-2",onClick:E,disabled:h.loading,children:[h.loading?e.jsx(q,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(je,{className:"mr-2 h-4 w-4"}),"Try Again"]})]})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-blue-600 to-green-500 px-6 py-6 shadow-md flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-white drop-shadow",children:"User Management"}),e.jsx("p",{className:"text-blue-100 mt-1 text-base",children:"Manage user accounts and permissions"})]}),e.jsxs(_,{onClick:()=>M(!0),className:"bg-white text-blue-700 hover:bg-blue-50 border-blue-200 border font-semibold shadow-sm",children:[e.jsx(be,{className:"mr-2 h-4 w-4 text-green-600"})," Add User"]})]}),e.jsxs(ce,{className:"bg-gradient-to-br from-blue-50 via-green-50 to-white border-2 border-blue-100/60 shadow-lg",children:[e.jsx(ue,{className:"bg-gradient-to-r from-blue-100/60 to-green-100/60 rounded-t-2xl px-6 py-4 border-b border-green-200/40",children:e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 w-full",children:e.jsxs("div",{className:"w-full",children:[e.jsx(me,{className:"text-lg mb-1 text-blue-700 font-bold tracking-wide",children:"Users"}),e.jsxs("div",{className:"flex flex-row gap-4 items-center",children:[e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-blue-400"}),e.jsx(T,{placeholder:"Search users...",value:f,onChange:s=>v(s.target.value),className:"w-full pl-9 bg-white/70 border border-blue-200 focus:border-green-400"})]}),e.jsxs("span",{className:"ml-2 text-sm text-green-700 font-medium bg-green-100/70 rounded-xl px-3 py-1",children:[V.length," user",V.length!==1?"s":""]})]})]})})}),e.jsx(he,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto rounded-b-2xl",children:e.jsxs(ge,{className:"min-w-full divide-y divide-blue-100",children:[e.jsx(xe,{className:"bg-gradient-to-r from-blue-100/40 to-green-100/40",children:e.jsxs($,{children:[e.jsx(N,{className:"text-blue-700 font-semibold",children:"Name"}),e.jsx(N,{className:"text-blue-700 font-semibold",children:"Email"}),e.jsx(N,{className:"text-green-700 font-semibold",children:"Role"}),e.jsx(N,{className:"text-green-700 font-semibold",children:"Position"}),e.jsx(N,{className:"text-blue-700 font-semibold",children:"Status"}),e.jsx(N,{className:"text-right text-blue-700 font-semibold",children:"Actions"})]})}),e.jsx(fe,{children:V.map(s=>e.jsxs($,{className:"hover:bg-blue-50/60",children:[e.jsxs(C,{className:"font-medium text-blue-900",children:[s.first_name," ",s.last_name]}),e.jsx(C,{className:"text-blue-800",children:s.email}),e.jsx(C,{children:e.jsx(X,{variant:"outline",className:"capitalize border-green-300 text-green-700 bg-green-50/80",children:s.role.replace("_"," ")})}),e.jsx(C,{className:"text-green-800",children:s.position}),e.jsx(C,{children:e.jsx(X,{variant:s.status==="active"?"default":"destructive",className:s.status==="active"?"bg-green-100 text-green-700 border-green-300":"bg-red-100 text-red-700 border-red-300",children:s.status})}),e.jsx(C,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",className:"h-8 w-8 p-0 border-blue-200 text-blue-700 hover:bg-blue-100/60",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(_,{variant:"destructive",size:"sm",className:"h-8 w-8 p-0 border-red-200 text-red-700 hover:bg-red-100/60",onClick:a=>{console.log("Delete button clicked"),a.stopPropagation(),W(s)},children:e.jsx(we,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]}),e.jsx(te,{open:b,onOpenChange:M,children:e.jsxs(ne,{className:"sm:max-w-4xl w-[90vw] max-w-[90vw]",children:[e.jsxs(ie,{className:"px-1",children:[e.jsx(oe,{className:"text-2xl font-bold text-blue-800",children:"Add New User"}),e.jsx(le,{className:"text-blue-600",children:"Create a new user account with the appropriate permissions and access levels."})]}),e.jsxs("form",{onSubmit:Q,children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 py-2",children:[e.jsxs("div",{className:"flex-1 bg-gradient-to-br from-blue-50 to-green-50 rounded-xl p-6 shadow-sm border border-blue-100",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-blue-700",children:"Personal Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"first_name",children:"First Name"}),e.jsx(T,{id:"first_name",placeholder:"John",value:r.first_name,onChange:s=>p(a=>({...a,first_name:s.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"last_name",children:"Last Name"}),e.jsx(T,{id:"last_name",placeholder:"Doe",value:r.last_name,onChange:s=>p(a=>({...a,last_name:s.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"email",children:"Email"}),e.jsx(T,{id:"email",type:"email",placeholder:"john.doe@example.com",value:r.email,onChange:s=>p(a=>({...a,email:s.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"password",children:"Password"}),e.jsx(T,{id:"password",type:"password",placeholder:"••••••••",value:r.password,onChange:s=>p(a=>({...a,password:s.target.value})),required:!0,minLength:8}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Password must be at least 8 characters long"})]})]})]}),e.jsxs("div",{className:"flex-1 bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-6 shadow-sm border border-green-100",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-green-700",children:"Role & Assignment"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"position",children:"Position"}),e.jsxs(k,{value:r.position,onValueChange:s=>p(a=>({...a,position:s})),children:[e.jsx(R,{children:e.jsx(F,{placeholder:"Select position"})}),e.jsxs(D,{children:[e.jsx(g,{value:"DFO",children:"DFO"}),e.jsx(g,{value:"Ranger",children:"Ranger"}),e.jsx(g,{value:"Guard",children:"Guard"}),e.jsx(g,{value:"Officer",children:"Officer"}),e.jsx(g,{value:"Manager",children:"Manager"}),e.jsx(g,{value:"Admin",children:"Admin"})]})]})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"role",children:"Role"}),e.jsxs(k,{value:r.role,onValueChange:s=>p(a=>({...a,role:s})),children:[e.jsx(R,{children:e.jsx(F,{placeholder:"Select role"})}),e.jsxs(D,{children:[e.jsx(g,{value:"admin",children:"Admin"}),e.jsx(g,{value:"manager",children:"Manager"}),e.jsx(g,{value:"data_collector",children:"Data Collector"}),e.jsx(g,{value:"viewer",children:"Viewer"})]})]})]}),["DFO","Ranger","Guard"].includes(r.position)&&e.jsxs("div",{children:[e.jsx(j,{children:"Division"}),e.jsxs(k,{value:r.division_id||"",onValueChange:s=>p(a=>({...a,division_id:s})),disabled:A.length===0,children:[e.jsx(R,{children:e.jsx(F,{placeholder:A.length===0?"Loading divisions...":"Select division"})}),e.jsx(D,{children:A.map(s=>e.jsx(g,{value:s.id,children:s.name},s.id))})]})]}),["Ranger","Guard"].includes(r.position)&&r.division_id&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{children:"Range"}),O&&e.jsxs("span",{className:"text-xs text-blue-600 flex items-center",children:[e.jsx(q,{className:"h-3 w-3 mr-1 animate-spin"}),"Loading..."]})]}),e.jsxs(k,{value:r.range_id||"",onValueChange:s=>p(a=>({...a,range_id:s})),disabled:O||w!==null,children:[e.jsx(R,{className:w?"border-red-300":"",children:e.jsx(F,{placeholder:O?"Loading ranges...":w?"Error loading ranges":"Select range"})}),e.jsx(D,{children:w?e.jsx("div",{className:"text-sm text-red-600 p-2",children:w}):Z.length>0?Z.map(s=>e.jsx(g,{value:s.id,children:s.name},s.id)):e.jsx("div",{className:"text-sm text-muted-foreground p-2",children:"No ranges found"})})]}),w&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:w})]}),r.position==="Guard"&&r.range_id&&e.jsxs("div",{children:[e.jsx(j,{children:"Beat"}),e.jsxs(k,{value:r.beat_id||"",onValueChange:s=>p(a=>({...a,beat_id:s})),disabled:J.length===0,children:[e.jsx(R,{children:e.jsx(F,{placeholder:J.length===0?"Loading beats...":"Select beat"})}),e.jsx(D,{children:J.map(s=>e.jsx(g,{value:s.id,children:s.name},s.id))})]})]})]})]})]}),e.jsxs(de,{className:"gap-2",children:[e.jsx(_,{type:"button",variant:"outline",onClick:()=>M(!1),disabled:L,children:"Cancel"}),e.jsx(_,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",disabled:L,children:L?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create User"})]})]})]})})]})}export{Ue as default};
//# sourceMappingURL=AdminUsers-4BgzWclZ.js.map
